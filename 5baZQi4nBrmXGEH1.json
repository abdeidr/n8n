{
  "active": true,
  "activeVersion": {
    "updatedAt": "2025-12-22T19:49:50.441Z",
    "createdAt": "2025-12-22T19:49:50.441Z",
    "versionId": "a08ed1ac-e202-443c-9f00-f8811681ff65",
    "workflowId": "5baZQi4nBrmXGEH1",
    "nodes": [
      {
        "parameters": {
          "assignments": {
            "assignments": [
              {
                "id": "04868508-eb27-4b67-9dae-c883d48466d4",
                "name": "chat_id",
                "value": "={{ $json.body.data.key.remoteJid }}",
                "type": "string"
              },
              {
                "id": "48144532-1f21-4490-93e4-f6eeb2dfaa40",
                "name": "instance_name",
                "value": "={{ $json.body.instance }}",
                "type": "string"
              },
              {
                "id": "4073cc89-9702-4346-b6c2-7e619ee6f55d",
                "name": "api_key",
                "value": "[REDACTED]",
                "type": "string"
              },
              {
                "id": "a78a3578-e487-4dc4-bdc0-6e35e3df7013",
                "name": "url_server",
                "value": "={{ $json.body.server_url }}",
                "type": "string"
              },
              {
                "id": "005d7505-414e-42d0-ba75-390a2718043a",
                "name": "textoMensaje",
                "value": "={{ $json.body.data.message.conversation }}",
                "type": "string"
              },
              {
                "id": "b283725a-b70b-4324-8441-b5c1622e5e55",
                "name": "sessionKey",
                "value": "={{ $json.body.data.key.remoteJid }}",
                "type": "string"
              }
            ]
          },
          "options": {}
        },
        "type": "n8n-nodes-base.set",
        "typeVersion": 3.4,
        "position": [
          -1088,
          16
        ],
        "id": "1e24e1a0-83f4-42cf-a347-f1ccad7646c1",
        "name": "Edit Fields"
      },
      {
        "parameters": {
          "promptType": "define",
          "text": "={{ $('Redis4').item.json.response }}",
          "options": {
            "systemMessage": "=Eres el asistente virtual de **Cl√≠nica Dental Sonrisas**, una cl√≠nica dental moderna y profesional ubicada en Madrid. \n\nTu nombre es \"Sof√≠a\" y tu funci√≥n es atender a los pacientes de manera c√°lida, profesional y eficiente. \n\nPuedes leer mensajes o escuchar audios de los clientes.\n\n---\n\n## Tu Personalidad y Tono\n\n- Eres amable, emp√°tica y profesional\n- Usas un tono cercano pero respetuoso (tuteo amable)\n- Eres paciente y comprensiva, especialmente con personas que tienen ansiedad dental\n- Respondes de manera clara y concisa\n- Nunca proporcionas diagn√≥sticos m√©dicos, solo informaci√≥n general\n\n---\n\n## Tus Capacidades\n\n### 1. GESTI√ìN DE CITAS\n\n- Consultar disponibilidad de citas\n- Agendar nuevas citas (recoger: nombre completo, tel√©fono, email, motivo, fecha/hora preferida)\n- Modificar citas existentes\n- Cancelar citas (solicitar n√∫mero de cita o datos del paciente)\n- Enviar recordatorios\n\n### 2. INFORMACI√ìN DE SERVICIOS\n\nPuedes informar sobre estos tratamientos:\n\n- **Odontolog√≠a General**: Limpiezas, empastes, extracciones\n- **Est√©tica Dental**: Blanqueamiento, carillas, dise√±o de sonrisa\n- **Ortodoncia**: Brackets met√°licos, brackets est√©ticos, Invisalign\n- **Implantolog√≠a**: Implantes dentales, pr√≥tesis sobre implantes\n- **Endodoncia**: Tratamientos de conducto\n- **Periodoncia**: Tratamiento de enc√≠as\n- **Odontopediatr√≠a**: Atenci√≥n dental para ni√±os\n- **Cirug√≠a Oral**: Extracciones complejas, muelas del juicio\n\n### 3. INFORMACI√ìN GENERAL\n\n- **Horarios**: Lunes a Viernes 9:00-20:00, S√°bados 9:00-14:00\n- **Ubicaci√≥n**: Calle Serrano 45, 28006 Madrid\n- **Tel√©fono**: +34 915 123 456\n- **Email**: info@clinicasonrisas.es\n- **Seguros m√©dicos**: Sanitas, Adeslas, Asisa, DKV\n- **Primera visita GRATUITA** (incluye revisi√≥n y diagn√≥stico)\n\n### 4. PRECIOS Y PRESUPUESTOS\n\n- Proporciona rangos de precios generales\n- Para presupuestos espec√≠ficos, agenda una cita de valoraci√≥n gratuita\n- Informa sobre opciones de financiaci√≥n disponibles (hasta 24 meses sin intereses)\n\n### 5. URGENCIAS\n\n- Identifica urgencias dentales: dolor intenso, traumatismo, sangrado abundante\n- Para urgencias: ofrecer cita el mismo d√≠a o derivar a urgencias si es fuera de horario\n- **L√≠nea de urgencias 24h**: +34 666 789 012\n\n---\n\n## Flujo de Conversaci√≥n\n\n### Al Inicio\n\n1. Saluda cordialmente\n2. Pregunta en qu√© puedes ayudar\n3. Identifica la necesidad del paciente\n\n### Durante la Conversaci√≥n\n\n1. Haz preguntas espec√≠ficas para entender mejor la necesidad\n2. Proporciona informaci√≥n clara y relevante\n3. Si vas a agendar cita, recopila TODOS los datos necesarios\n4. Confirma la informaci√≥n antes de finalizar\n\n### Al Finalizar\n\n1. Resume lo acordado (especialmente si agendaste cita)\n2. Pregunta si necesita algo m√°s\n3. Desp√≠dete de manera c√°lida\n4. Si agendaste cita, menciona que recibir√° confirmaci√≥n por email/SMS\n\n---\n\n## Casos Especiales\n\n**Si el paciente pregunta por un dentista espec√≠fico:**\n- Consulta la base de datos de profesionales\n- Informa disponibilidad del doctor/a solicitado\n\n**Si el paciente tiene ansiedad dental:**\n- S√© extra emp√°tica\n- Menciona que ofrecemos sedaci√≥n consciente\n- Resalta que nuestros doctores son muy delicados\n\n**Si el paciente pregunta por un tratamiento que no conoces:**\n- No inventes informaci√≥n\n- Ofrece agendar una cita de valoraci√≥n gratuita con el especialista\n\n**Si detectas una urgencia:**\n- Prioriza la atenci√≥n\n- Ofrece el hueco m√°s cercano posible\n- Si es fuera de horario, da el n√∫mero de urgencias 24h\n\n---\n\n## Restricciones IMPORTANTES\n\n‚ùå NUNCA diagnostiques condiciones m√©dicas  \n‚ùå NUNCA recomiendes medicamentos espec√≠ficos  \n‚ùå NUNCA confirmes una cita sin tener TODOS los datos necesarios  \n‚ùå NUNCA des informaci√≥n sobre historiales m√©dicos de pacientes  \n‚ùå NUNCA proceses pagos (deriva a recepci√≥n)\n\n---\n\n## Datos que SIEMPRE debes recopilar para agendar cita\n\nPregunta UNA POR UNA, esperando la respuesta antes de continuar:\n\n1. Nombre completo\n2. Tel√©fono de contacto\n3. Email\n4. Motivo de la consulta\n5. Fecha preferida y Hora preferida (dentro del horario: Lunes a Viernes 9:00-20:00, S√°bados 9:00-14:00)\n6. ¬øEs primera visita?\n7. ¬øTiene seguro m√©dico? ¬øCu√°l?\n\n---\n\n## Proceso OBLIGATORIO despu√©s de agendar la cita\n\nUna vez que hayas recopilado TODOS los datos y confirmado la cita con el paciente:\n\n1. **ENV√çA INMEDIATAMENTE un email de confirmaci√≥n** al email proporcionado por el paciente usando la tool 'Send a message in Gmail'\n\n2. El email debe incluir:\n   - Fecha y hora de la cita\n   - Motivo de la consulta\n   - Nombre del paciente\n   - Datos de contacto de la cl√≠nica\n   - Recordatorio de llegar 10 minutos antes\n\n3. **Despu√©s de enviar el email**, informa al paciente que ya le has enviado la confirmaci√≥n\n\n---\n\n## Formato de Respuesta - REGLAS CR√çTICAS\n\n### Reglas de formato OBLIGATORIAS:\n\n- Usa p√°rrafos cortos y f√°ciles de leer\n- **NUNCA escribas bloques de texto largos sin saltos de l√≠nea**\n- Para listas de informaci√≥n (precios, servicios, horarios), usa SIEMPRE vi√±etas o bullets (-)\n- Usa emojis ocasionalmente para ser m√°s cercana (üòä ü¶∑ üìÖ)\n- Si proporcionas listas, hazlas claras y organizadas con bullets\n- Incluye calls-to-action claros (\"¬øTe gustar√≠a que agenda una cita?\")\n- **IMPORTANTE: Usa saltos de l√≠nea entre oraciones para mejor legibilidad**\n- **Separa ideas diferentes en p√°rrafos distintos**\n\n---\n\n## Ejemplos de Respuestas Bien Formateadas\n\n### Ejemplo 1 - Despedida:\n\n```\n¬°De nada! üòä\n\nHa sido un placer ayudarte.\n\nTe esperamos en Cl√≠nica Dental Sonrisas el viernes a las 11:00.\n\nCu√≠date mucho y que tengas un excelente d√≠a.\n\n¬°Hasta pronto! ü¶∑\n```\n\n### Ejemplo 2 - Lista de servicios:\n\n```\nClaro, te cuento los servicios que ofrecemos en Cl√≠nica Dental Sonrisas:\n\n- Odontolog√≠a General: Limpiezas, empastes, extracciones\n- Est√©tica Dental: Blanqueamiento, carillas, dise√±o de sonrisa\n- Ortodoncia: Brackets met√°licos, brackets est√©ticos, Invisalign\n- Implantolog√≠a: Implantes dentales, pr√≥tesis sobre implantes\n- Endodoncia: Tratamientos de conducto\n- Periodoncia: Tratamiento de enc√≠as\n- Odontopediatr√≠a: Atenci√≥n dental para ni√±os\n- Cirug√≠a Oral: Extracciones complejas, muelas del juicio\n\n¬øHay alg√∫n tratamiento que te interese en particular o quieres que te ayude a agendar una cita de valoraci√≥n? üòä\n```\n\n### Ejemplo 3 - Precios:\n\n```\nLos precios pueden variar seg√∫n el tratamiento, pero para darte una idea general:\n\n- Limpieza dental: entre 40 y 80 euros\n- Empastes: desde 60 euros\n- Blanqueamiento dental: de 150 a 300 euros\n- Ortodoncia brackets met√°licos: a partir de 1.500 euros\n- Invisalign: desde 3.000 euros\n- Implantes dentales: alrededor de 1.200 a 1.800 euros por implante\n\nPara un presupuesto exacto y detallado, te recomiendo agendar una cita de valoraci√≥n gratuita con nuestro especialista.\n\nAdem√°s, contamos con opciones de financiaci√≥n hasta 24 meses sin intereses.\n\n¬øQuieres que te ayude a reservar tu cita? üìÖ\n```\n\n### Ejemplo 4 - Confirmaci√≥n de cita:\n\n```\nPerfecto, Abde.\n\nTe confirmo tu cita:\n\nüìÖ Fecha: Viernes 31 de octubre\nüïê Hora: 11:00 h\nü¶∑ Motivo: Limpieza dental\n‚úÖ Primera visita: S√≠\nüí≥ Seguro m√©dico: No\n\nRecibir√°s una confirmaci√≥n por email y un recordatorio antes de la cita.\n\n¬øQuieres que te ayude con algo m√°s? üòä\n```\n\n---\n\n## Herramientas Disponibles\n\nPara acceder a la base de datos, usa el AI agent \"base de datos\" como tool.\n\nLa fecha de hoy es {{ $json.fechaActual }}\n\n---\n\n## Recordatorio Final\n\nTu objetivo es hacer que cada interacci√≥n sea positiva, eficiente y que el paciente se sienta bien atendido y con ganas de visitar nuestra cl√≠nica. \n\n¬°Eres la primera impresi√≥n de Cl√≠nica Dental Sonrisas! ü¶∑‚ú®\n```\n\nEste prompt ahora est√° mucho mejor estructurado con:[1][5]\n\n- **Secciones claramente separadas** con headers\n- **Listas con bullets** para mejor legibilidad\n- **Separadores visuales** (---) entre secciones\n- **Ejemplos formateados** en bloques de c√≥digo\n- **√ânfasis visual** con negritas para puntos clave\n- **Emojis estrat√©gicos** para humanizar el tono\n"
          }
        },
        "type": "@n8n/n8n-nodes-langchain.agent",
        "typeVersion": 1.9,
        "position": [
          1472,
          -32
        ],
        "id": "410eccbc-9a76-4b72-ad45-4962286d990e",
        "name": "AI Agent1"
      },
      {
        "parameters": {
          "rules": {
            "values": [
              {
                "conditions": {
                  "options": {
                    "caseSensitive": true,
                    "leftValue": "",
                    "typeValidation": "strict",
                    "version": 2
                  },
                  "conditions": [
                    {
                      "leftValue": "={{ $('Webhook').item.json.body.data.message.audioMessage.mimetype }}",
                      "rightValue": "=audio/ogg; codecs=opus",
                      "operator": {
                        "type": "string",
                        "operation": "equals"
                      },
                      "id": "be9dbcd5-0882-4ce9-9822-305865fae492"
                    }
                  ],
                  "combinator": "and"
                },
                "renameOutput": true,
                "outputKey": "Audio"
              },
              {
                "conditions": {
                  "options": {
                    "caseSensitive": true,
                    "leftValue": "",
                    "typeValidation": "strict",
                    "version": 2
                  },
                  "conditions": [
                    {
                      "id": "6a0ec742-7f93-4ea1-af39-35d410da1c1a",
                      "leftValue": "={{ $('Webhook').item.json.body.data.messageType }}",
                      "rightValue": "conversation",
                      "operator": {
                        "type": "string",
                        "operation": "equals",
                        "name": "filter.operator.equals"
                      }
                    }
                  ],
                  "combinator": "and"
                },
                "renameOutput": true,
                "outputKey": "Texto"
              },
              {
                "conditions": {
                  "options": {
                    "caseSensitive": true,
                    "leftValue": "",
                    "typeValidation": "strict",
                    "version": 2
                  },
                  "conditions": [
                    {
                      "id": "355e579a-2bc2-4c36-af8e-cf3639cc07fa",
                      "leftValue": "={{ $('Webhook').item.json.body.data.messageType }}",
                      "rightValue": "imageMessage",
                      "operator": {
                        "type": "string",
                        "operation": "equals",
                        "name": "filter.operator.equals"
                      }
                    }
                  ],
                  "combinator": "and"
                },
                "renameOutput": true,
                "outputKey": "imagen"
              }
            ]
          },
          "options": {}
        },
        "type": "n8n-nodes-base.switch",
        "typeVersion": 3.2,
        "position": [
          -912,
          0
        ],
        "id": "18798a96-bb34-4fc8-aa5a-b9a744c78a88",
        "name": "Switch"
      },
      {
        "parameters": {
          "resource": "audio",
          "operation": "transcribe",
          "options": {
            "language": "es"
          }
        },
        "type": "@n8n/n8n-nodes-langchain.openAi",
        "typeVersion": 1.8,
        "position": [
          -896,
          -240
        ],
        "id": "4e2325d4-3801-49c4-b39d-7f57a8453d9d",
        "name": "Transcribir audio",
        "credentials": {},
        "notes": "los audios estan en espa√±ol"
      },
      {
        "parameters": {
          "assignments": {
            "assignments": [
              {
                "id": "defa1545-074d-4d6a-a21f-a95c2226995f",
                "name": "mensajeAudioOTexto",
                "value": "={{ $json.text || $('Webhook').item.json.body.data.message.conversation || $json.content }}",
                "type": "string"
              }
            ]
          },
          "options": {}
        },
        "type": "n8n-nodes-base.set",
        "typeVersion": 3.4,
        "position": [
          -528,
          -32
        ],
        "id": "14220fd6-55ab-4156-a78c-b38795ee3e81",
        "name": "Mapear mensaje"
      },
      {
        "parameters": {
          "rules": {
            "values": [
              {
                "conditions": {
                  "options": {
                    "caseSensitive": true,
                    "leftValue": "",
                    "typeValidation": "strict",
                    "version": 2
                  },
                  "conditions": [
                    {
                      "leftValue": "={{ $('Mapear mensaje').item.json.mensajeAudioOTexto }}",
                      "rightValue": "[null]",
                      "operator": {
                        "type": "string",
                        "operation": "notEquals"
                      },
                      "id": "ea1ce058-1302-4e81-9680-f70a12960a82"
                    }
                  ],
                  "combinator": "and"
                }
              }
            ]
          },
          "options": {}
        },
        "type": "n8n-nodes-base.switch",
        "typeVersion": 3.2,
        "position": [
          -192,
          0
        ],
        "id": "2e878e36-42ac-4457-b804-84c12437ab9c",
        "name": "Switch1"
      },
      {
        "parameters": {
          "operation": "toBinary",
          "sourceProperty": "data.base64",
          "options": {
            "mimeType": "audio/mp3"
          }
        },
        "type": "n8n-nodes-base.convertToFile",
        "typeVersion": 1.1,
        "position": [
          -1088,
          -240
        ],
        "id": "348546a2-a6f4-4c5f-8c45-5e56e5854e82",
        "name": "Convert to File"
      },
      {
        "parameters": {
          "resource": "chat-api",
          "operation": "get-media-base64",
          "instanceName": "calidaxBot",
          "messageId": "={{ $('Webhook').item.json.body.data.key.id }}"
        },
        "type": "n8n-nodes-evolution-api.evolutionApi",
        "typeVersion": 1,
        "position": [
          -1280,
          -240
        ],
        "id": "0e0ec54b-e84a-43b3-808b-fab1bda459f8",
        "name": "Obter m dia em base64",
        "credentials": {}
      },
      {
        "parameters": {
          "sessionIdType": "customKey",
          "sessionKey": "={{ $('Edit Fields').item.json.sessionKey }}"
        },
        "type": "@n8n/n8n-nodes-langchain.memoryPostgresChat",
        "typeVersion": 1.3,
        "position": [
          1360,
          400
        ],
        "id": "5b10fc91-76c5-49a8-b8e9-630891e4b395",
        "name": "Postgres Chat Memory",
        "credentials": {}
      },
      {
        "parameters": {
          "model": {
            "__rl": true,
            "mode": "list",
            "value": "gpt-4.1-mini"
          },
          "options": {}
        },
        "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
        "typeVersion": 1.2,
        "position": [
          1248,
          224
        ],
        "id": "771fe5d9-b94e-472d-824e-a3bef231e826",
        "name": "OpenAI Chat Model",
        "credentials": {}
      },
      {
        "parameters": {
          "rules": {
            "values": [
              {
                "conditions": {
                  "options": {
                    "caseSensitive": true,
                    "leftValue": "",
                    "typeValidation": "strict",
                    "version": 2
                  },
                  "conditions": [
                    {
                      "leftValue": "={{ $('Webhook').item.json.body.data.key.fromMe.toString() }}",
                      "rightValue": "=false",
                      "operator": {
                        "type": "string",
                        "operation": "equals"
                      },
                      "id": "84f1ac15-47a9-4f36-b8b0-73ea0edc3ecc"
                    }
                  ],
                  "combinator": "and"
                }
              }
            ]
          },
          "options": {}
        },
        "type": "n8n-nodes-base.switch",
        "typeVersion": 3.2,
        "position": [
          -1520,
          -240
        ],
        "id": "904c9131-6b4a-4234-a77c-f613ac8c06a5",
        "name": "es mandado por el cliente"
      },
      {
        "parameters": {
          "amount": 1
        },
        "type": "n8n-nodes-base.wait",
        "typeVersion": 1.1,
        "position": [
          208,
          -16
        ],
        "id": "01c50c79-63f4-4d6b-a93c-74bd44f2e469",
        "name": "Wait",
        "webhookId": "REDACTED"
      },
      {
        "parameters": {
          "conditions": {
            "options": {
              "caseSensitive": true,
              "leftValue": "",
              "typeValidation": "strict",
              "version": 2
            },
            "conditions": [
              {
                "id": "8ac5729a-0f8a-4564-b4f9-dd5e1fcb4c05",
                "leftValue": "={{ $json.message.last() }}",
                "rightValue": "={{ $('Mapear mensaje').item.json.mensajeAudioOTexto }}",
                "operator": {
                  "type": "string",
                  "operation": "equals",
                  "name": "filter.operator.equals"
                }
              }
            ],
            "combinator": "and"
          },
          "options": {}
        },
        "type": "n8n-nodes-base.if",
        "typeVersion": 2.2,
        "position": [
          624,
          -16
        ],
        "id": "e30c0eb4-76c0-4570-aaf8-7ea8af539ae3",
        "name": "If"
      },
      {
        "parameters": {},
        "type": "n8n-nodes-base.noOp",
        "typeVersion": 1,
        "position": [
          928,
          288
        ],
        "id": "ebc7b712-0eb1-44de-bd71-6ae401a17303",
        "name": "No Operation, do nothing"
      },
      {
        "parameters": {
          "assignments": {
            "assignments": [
              {
                "id": "4a46e63b-2ead-4f35-aaa2-ab4ef5fc69f2",
                "name": "response",
                "value": "={{ $('Redis3').item.json.message }}",
                "type": "string"
              }
            ]
          },
          "options": {}
        },
        "type": "n8n-nodes-base.set",
        "typeVersion": 3.4,
        "position": [
          912,
          -32
        ],
        "id": "3f866252-6789-4cb5-8b5a-4986da43379b",
        "name": "pregunta_usuario"
      },
      {
        "parameters": {
          "conditions": {
            "options": {
              "caseSensitive": true,
              "leftValue": "",
              "typeValidation": "strict",
              "version": 2
            },
            "conditions": [
              {
                "id": "641c492a-2026-49ba-81d8-31d19976fd99",
                "leftValue": "={{ $json.body.data.key.fromMe.toString() }}",
                "rightValue": "false",
                "operator": {
                  "type": "string",
                  "operation": "equals",
                  "name": "filter.operator.equals"
                }
              }
            ],
            "combinator": "and"
          },
          "options": {}
        },
        "type": "n8n-nodes-base.if",
        "typeVersion": 2.2,
        "position": [
          -1728,
          32
        ],
        "id": "9c0b9346-5ca8-4fae-a138-8da9f767bf74",
        "name": "If1"
      },
      {
        "parameters": {
          "conditions": {
            "options": {
              "caseSensitive": true,
              "leftValue": "",
              "typeValidation": "strict",
              "version": 2
            },
            "conditions": [
              {
                "id": "62cf7f96-e1f3-4350-850c-548e2291ed79",
                "leftValue": "={{ $('Webhook').item.json.body.data.key.remoteJid }}",
                "rightValue": "34641750559@s.whatsapp.net",
                "operator": {
                  "type": "string",
                  "operation": "equals",
                  "name": "filter.operator.equals"
                }
              }
            ],
            "combinator": "and"
          },
          "options": {}
        },
        "type": "n8n-nodes-base.if",
        "typeVersion": 2.2,
        "position": [
          -352,
          -16
        ],
        "id": "3670b18a-113f-4f2b-ac92-e8088e606256",
        "name": "If2"
      },
      {
        "parameters": {
          "calendar": {
            "__rl": true,
            "value": "aimaspain.contacto@gmail.com",
            "mode": "list",
            "cachedResultName": "aimaspain.contacto@gmail.com"
          },
          "start": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('Start', ``, 'string') }}",
          "end": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('End', ``, 'string') }}",
          "useDefaultReminders": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('Use_Default_Reminders', ``, 'boolean') }}",
          "additionalFields": {
            "attendees": [
              "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('attendees0_Attendees', ``, 'string') }}",
              "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('attendees1_Attendees', ``, 'string') }}"
            ],
            "description": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('Description', ``, 'string') }}"
          }
        },
        "type": "n8n-nodes-base.googleCalendarTool",
        "typeVersion": 1.3,
        "position": [
          1968,
          384
        ],
        "id": "42fde3cc-8599-4f5e-8324-f066ad25b3cc",
        "name": "Create an event in Google Calendar",
        "credentials": {}
      },
      {
        "parameters": {
          "operation": "delete",
          "calendar": {
            "__rl": true,
            "value": "aimaspain.contacto@gmail.com",
            "mode": "list",
            "cachedResultName": "aimaspain.contacto@gmail.com"
          },
          "eventId": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('Event_ID', ``, 'string') }}",
          "options": {}
        },
        "type": "n8n-nodes-base.googleCalendarTool",
        "typeVersion": 1.3,
        "position": [
          1840,
          384
        ],
        "id": "fcd45152-33f5-441d-bbbf-0ab66ffc40c5",
        "name": "Delete an event in Google Calendar",
        "credentials": {}
      },
      {
        "parameters": {
          "operation": "getAll",
          "calendar": {
            "__rl": true,
            "value": "aimaspain.contacto@gmail.com",
            "mode": "list",
            "cachedResultName": "aimaspain.contacto@gmail.com"
          },
          "returnAll": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('Return_All', ``, 'boolean') }}",
          "timeMin": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('After', ``, 'string') }}",
          "timeMax": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('Before', ``, 'string') }}",
          "options": {}
        },
        "type": "n8n-nodes-base.googleCalendarTool",
        "typeVersion": 1.3,
        "position": [
          1744,
          384
        ],
        "id": "198c03c0-fcdb-49ae-9b82-83cf8e534a57",
        "name": "Get many events in Google Calendar",
        "credentials": {}
      },
      {
        "parameters": {
          "resource": "messages-api",
          "instanceName": "calidaxBot",
          "remoteJid": "={{ $('Code in JavaScript1').item.json.chat_id }}",
          "messageText": "={{ $('AI Agent1').item.json.output }}",
          "options_message": {}
        },
        "type": "n8n-nodes-evolution-api.evolutionApi",
        "typeVersion": 1,
        "position": [
          2432,
          -32
        ],
        "id": "07f0ea4e-245a-4b30-9960-ad73c85eae7c",
        "name": "Enviar texto",
        "credentials": {}
      },
      {
        "parameters": {
          "text": "=esta es tu base de datos:\n{\n  \"clinica\": {\n    \"nombre\": \"Cl√≠nica Dental Sonrisas\",\n    \"direccion\": \"Calle Serrano 45, 28006 Madrid\",\n    \"telefono\": \"+34 915 123 456\",\n    \"email\": \"info@clinicasonrisas.es\",\n    \"urgencias_24h\": \"+34 666 789 012\",\n    \"horarios\": {\n      \"lunes_viernes\": \"09:00 - 20:00\",\n      \"sabado\": \"09:00 - 14:00\",\n      \"domingo\": \"Cerrado\"\n    },\n    \"redes_sociales\": {\n      \"instagram\": \"@clinicasonrisas\",\n      \"facebook\": \"ClinicaDentalSonrisas\"\n    }\n  },\n\n  \"servicios\": [\n    {\n      \"id\": \"ODG001\",\n      \"categoria\": \"Odontolog√≠a General\",\n      \"nombre\": \"Limpieza Dental Profunda\",\n      \"descripcion\": \"Eliminaci√≥n de sarro y placa bacteriana con ultrasonido y pulido\",\n      \"duracion_minutos\": 45,\n      \"precio_desde\": 60,\n      \"precio_hasta\": 90\n    },\n    {\n      \"id\": \"ODG002\",\n      \"categoria\": \"Odontolog√≠a General\",\n      \"nombre\": \"Empaste Composite\",\n      \"descripcion\": \"Restauraci√≥n de caries con material est√©tico del color del diente\",\n      \"duracion_minutos\": 30,\n      \"precio_desde\": 50,\n      \"precio_hasta\": 100\n    },\n    {\n      \"id\": \"ODG003\",\n      \"categoria\": \"Odontolog√≠a General\",\n      \"nombre\": \"Extracci√≥n Simple\",\n      \"descripcion\": \"Extracci√≥n de pieza dental sin complicaciones\",\n      \"duracion_minutos\": 30,\n      \"precio_desde\": 50,\n      \"precio_hasta\": 80\n    },\n    {\n      \"id\": \"EST001\",\n      \"categoria\": \"Est√©tica Dental\",\n      \"nombre\": \"Blanqueamiento LED\",\n      \"descripcion\": \"Blanqueamiento dental profesional con tecnolog√≠a LED\",\n      \"duracion_minutos\": 60,\n      \"precio_desde\": 250,\n      \"precio_hasta\": 350\n    },\n    {\n      \"id\": \"EST002\",\n      \"categoria\": \"Est√©tica Dental\",\n      \"nombre\": \"Carillas de Porcelana\",\n      \"descripcion\": \"L√°minas de porcelana para transformar la sonrisa\",\n      \"duracion_minutos\": 120,\n      \"precio_desde\": 400,\n      \"precio_hasta\": 600,\n      \"precio_por\": \"pieza\"\n    },\n    {\n      \"id\": \"EST003\",\n      \"categoria\": \"Est√©tica Dental\",\n      \"nombre\": \"Dise√±o de Sonrisa Digital\",\n      \"descripcion\": \"Planificaci√≥n digital de tu nueva sonrisa con vista previa\",\n      \"duracion_minutos\": 60,\n      \"precio_desde\": 150,\n      \"precio_hasta\": 250\n    },\n    {\n      \"id\": \"ORT001\",\n      \"categoria\": \"Ortodoncia\",\n      \"nombre\": \"Brackets Met√°licos\",\n      \"descripcion\": \"Ortodoncia tradicional con brackets met√°licos\",\n      \"duracion_meses\": \"18-24\",\n      \"precio_desde\": 2500,\n      \"precio_hasta\": 3500,\n      \"incluye\": \"Estudio, brackets, revisiones mensuales, retenedores\"\n    },\n    {\n      \"id\": \"ORT002\",\n      \"categoria\": \"Ortodoncia\",\n      \"nombre\": \"Brackets Est√©ticos (Zafiro)\",\n      \"descripcion\": \"Brackets transparentes de zafiro, pr√°cticamente invisibles\",\n      \"duracion_meses\": \"18-24\",\n      \"precio_desde\": 3500,\n      \"precio_hasta\": 4500\n    },\n    {\n      \"id\": \"ORT003\",\n      \"categoria\": \"Ortodoncia\",\n      \"nombre\": \"Invisalign\",\n      \"descripcion\": \"Alineadores invisibles removibles, tratamiento digital\",\n      \"duracion_meses\": \"12-18\",\n      \"precio_desde\": 3800,\n      \"precio_hasta\": 5500\n    },\n    {\n      \"id\": \"IMP001\",\n      \"categoria\": \"Implantolog√≠a\",\n      \"nombre\": \"Implante Dental Unitario\",\n      \"descripcion\": \"Implante de titanio con corona de porcelana\",\n      \"duracion_meses\": \"3-6\",\n      \"precio_desde\": 1200,\n      \"precio_hasta\": 1800,\n      \"incluye\": \"Implante, pilar, corona, cirug√≠a\"\n    },\n    {\n      \"id\": \"IMP002\",\n      \"categoria\": \"Implantolog√≠a\",\n      \"nombre\": \"Pr√≥tesis Completa sobre 4 Implantes\",\n      \"descripcion\": \"Rehabilitaci√≥n completa de arcada con t√©cnica All-on-4\",\n      \"duracion_meses\": \"4-8\",\n      \"precio_desde\": 8000,\n      \"precio_hasta\": 12000\n    },\n    {\n      \"id\": \"END001\",\n      \"categoria\": \"Endodoncia\",\n      \"nombre\": \"Endodoncia (Matar Nervio)\",\n      \"descripcion\": \"Tratamiento de conductos radiculares para salvar la pieza\",\n      \"duracion_minutos\": 90,\n      \"precio_desde\": 200,\n      \"precio_hasta\": 400,\n      \"sesiones\": \"1-2\"\n    },\n    {\n      \"id\": \"PER001\",\n      \"categoria\": \"Periodoncia\",\n      \"nombre\": \"Tratamiento Periodontal Completo\",\n      \"descripcion\": \"Curetaje y raspado para tratar enfermedad de enc√≠as\",\n      \"duracion_minutos\": 60,\n      \"precio_desde\": 400,\n      \"precio_hasta\": 800,\n      \"sesiones\": \"2-4\"\n    },\n    {\n      \"id\": \"PED001\",\n      \"categoria\": \"Odontopediatr√≠a\",\n      \"nombre\": \"Revisi√≥n Dental Infantil\",\n      \"descripcion\": \"Revisi√≥n completa con fluorizaci√≥n para ni√±os\",\n      \"duracion_minutos\": 30,\n      \"precio_desde\": 30,\n      \"precio_hasta\": 50\n    },\n    {\n      \"id\": \"CIR001\",\n      \"categoria\": \"Cirug√≠a Oral\",\n      \"nombre\": \"Extracci√≥n Muelas del Juicio\",\n      \"descripcion\": \"Extracci√≥n quir√∫rgica de cordales impactados\",\n      \"duracion_minutos\": 45,\n      \"precio_desde\": 150,\n      \"precio_hasta\": 300,\n      \"precio_por\": \"pieza\"\n    }\n  ],\n\n  \"doctores\": [\n    {\n      \"id\": \"DOC001\",\n      \"nombre\": \"Dra. Mar√≠a Gonz√°lez\",\n      \"especialidad\": \"Directora / Odontolog√≠a General\",\n      \"experiencia_anos\": 15,\n      \"idiomas\": [\"Espa√±ol\", \"Ingl√©s\"],\n      \"horario_atencion\": [\"Lunes\", \"Martes\", \"Mi√©rcoles\", \"Viernes\"],\n      \"disponibilidad_ma√±ana\": true,\n      \"disponibilidad_tarde\": true\n    },\n    {\n      \"id\": \"DOC002\",\n      \"nombre\": \"Dr. Carlos Ram√≠rez\",\n      \"especialidad\": \"Implantolog√≠a y Cirug√≠a\",\n      \"experiencia_anos\": 20,\n      \"idiomas\": [\"Espa√±ol\", \"Franc√©s\"],\n      \"horario_atencion\": [\"Martes\", \"Jueves\", \"Viernes\"],\n      \"disponibilidad_ma√±ana\": true,\n      \"disponibilidad_tarde\": false\n    },\n    {\n      \"id\": \"DOC003\",\n      \"nombre\": \"Dra. Ana Mart√≠nez\",\n      \"especialidad\": \"Ortodoncia e Invisalign\",\n      \"experiencia_anos\": 12,\n      \"certificaciones\": [\"Invisalign Diamond Provider\"],\n      \"idiomas\": [\"Espa√±ol\", \"Ingl√©s\", \"Portugu√©s\"],\n      \"horario_atencion\": [\"Lunes\", \"Mi√©rcoles\", \"Jueves\", \"S√°bado\"],\n      \"disponibilidad_ma√±ana\": true,\n      \"disponibilidad_tarde\": true\n    },\n    {\n      \"id\": \"DOC004\",\n      \"nombre\": \"Dr. Javier L√≥pez\",\n      \"especialidad\": \"Est√©tica Dental\",\n      \"experiencia_anos\": 10,\n      \"idiomas\": [\"Espa√±ol\", \"Ingl√©s\"],\n      \"horario_atencion\": [\"Lunes\", \"Martes\", \"Mi√©rcoles\", \"Jueves\"],\n      \"disponibilidad_ma√±ana\": false,\n      \"disponibilidad_tarde\": true\n    },\n    {\n      \"id\": \"DOC005\",\n      \"nombre\": \"Dra. Laura S√°nchez\",\n      \"especialidad\": \"Odontopediatr√≠a\",\n      \"experiencia_anos\": 8,\n      \"idiomas\": [\"Espa√±ol\"],\n      \"horario_atencion\": [\"Martes\", \"Jueves\", \"Viernes\", \"S√°bado\"],\n      \"disponibilidad_ma√±ana\": true,\n      \"disponibilidad_tarde\": true,\n      \"nota\": \"Especializada en ni√±os con ansiedad dental\"\n    }\n  ],\n\n  \"seguros_aceptados\": [\n    {\n      \"nombre\": \"Sanitas Dental\",\n      \"cobertura\": \"80% tratamientos b√°sicos, 50% especialidades\",\n      \"copago_consulta\": 0\n    },\n    {\n      \"nombre\": \"Adeslas Dental\",\n      \"cobertura\": \"Sin copago en limpieza anual, descuentos en tratamientos\",\n      \"copago_consulta\": 0\n    },\n    {\n      \"nombre\": \"Asisa Dental\",\n      \"cobertura\": \"Cuadro m√©dico completo, sin copagos en prevenci√≥n\",\n      \"copago_consulta\": 0\n    },\n    {\n      \"nombre\": \"DKV Dentisalud\",\n      \"cobertura\": \"Reembolso de tratamientos seg√∫n baremo\",\n      \"copago_consulta\": 15\n    },\n    {\n      \"nombre\": \"Cigna Dental\",\n      \"cobertura\": \"Red de cl√≠nicas concertadas\",\n      \"copago_consulta\": 10\n    }\n  ],\n\n  \"promociones_actuales\": [\n    {\n      \"id\": \"PROMO001\",\n      \"titulo\": \"Primera Visita GRATIS\",\n      \"descripcion\": \"Revisi√≥n completa, radiograf√≠a panor√°mica y diagn√≥stico sin coste\",\n      \"vigencia\": \"Permanente\",\n      \"condiciones\": \"Solo nuevos pacientes\"\n    },\n    {\n      \"id\": \"PROMO002\",\n      \"titulo\": \"Blanqueamiento + Limpieza\",\n      \"descripcion\": \"Pack especial: Blanqueamiento LED + Limpieza profunda por 280‚Ç¨ (ahorra 80‚Ç¨)\",\n      \"precio_normal\": 360,\n      \"precio_promocion\": 280,\n      \"vigencia\": \"Hasta 31/12/2025\"\n    },\n    {\n      \"id\": \"PROMO003\",\n      \"titulo\": \"Financiaci√≥n 0% Intereses\",\n      \"descripcion\": \"Financia tu tratamiento hasta 24 meses sin intereses\",\n      \"importe_minimo\": 600,\n      \"vigencia\": \"Permanente\"\n    }\n  ],\n\n  \"horarios_disponibles_template\": {\n    \"lunes\": {\n      \"ma√±ana\": [\"09:00\", \"09:30\", \"10:00\", \"10:30\", \"11:00\", \"11:30\", \"12:00\", \"12:30\", \"13:00\"],\n      \"tarde\": [\"16:00\", \"16:30\", \"17:00\", \"17:30\", \"18:00\", \"18:30\", \"19:00\", \"19:30\"]\n    },\n    \"martes\": {\n      \"ma√±ana\": [\"09:00\", \"09:30\", \"10:00\", \"10:30\", \"11:00\", \"11:30\", \"12:00\", \"12:30\", \"13:00\"],\n      \"tarde\": [\"16:00\", \"16:30\", \"17:00\", \"17:30\", \"18:00\", \"18:30\", \"19:00\", \"19:30\"]\n    },\n    \"miercoles\": {\n      \"ma√±ana\": [\"09:00\", \"09:30\", \"10:00\", \"10:30\", \"11:00\", \"11:30\", \"12:00\", \"12:30\", \"13:00\"],\n      \"tarde\": [\"16:00\", \"16:30\", \"17:00\", \"17:30\", \"18:00\", \"18:30\", \"19:00\", \"19:30\"]\n    },\n    \"jueves\": {\n      \"ma√±ana\": [\"09:00\", \"09:30\", \"10:00\", \"10:30\", \"11:00\", \"11:30\", \"12:00\", \"12:30\", \"13:00\"],\n      \"tarde\": [\"16:00\", \"16:30\", \"17:00\", \"17:30\", \"18:00\", \"18:30\", \"19:00\", \"19:30\"]\n    },\n    \"viernes\": {\n      \"ma√±ana\": [\"09:00\", \"09:30\", \"10:00\", \"10:30\", \"11:00\", \"11:30\", \"12:00\", \"12:30\", \"13:00\"],\n      \"tarde\": [\"16:00\", \"16:30\", \"17:00\", \"17:30\", \"18:00\", \"18:30\", \"19:00\", \"19:30\"]\n    },\n    \"sabado\": {\n      \"ma√±ana\": [\"09:00\", \"09:30\", \"10:00\", \"10:30\", \"11:00\", \"11:30\", \"12:00\", \"12:30\", \"13:00\"],\n      \"tarde\": []\n    }\n  },\n\n  \"citas_ejemplo\": [\n    {\n      \"id_cita\": \"CITA2025001\",\n      \"paciente\": {\n        \"nombre\": \"Juan P√©rez Garc√≠a\",\n        \"telefono\": \"+34 612 345 678\",\n        \"email\": \"juan.perez@email.com\",\n        \"primera_visita\": false,\n        \"seguro\": \"Sanitas Dental\"\n      },\n      \"fecha\": \"2025-10-08\",\n      \"hora\": \"10:00\",\n      \"doctor\": \"Dra. Mar√≠a Gonz√°lez\",\n      \"motivo\": \"Limpieza dental\",\n      \"estado\": \"confirmada\",\n      \"duracion_minutos\": 45\n    },\n    {\n      \"id_cita\": \"CITA2025002\",\n      \"paciente\": {\n        \"nombre\": \"Laura Mart√≠n L√≥pez\",\n        \"telefono\": \"+34 654 987 321\",\n        \"email\": \"laura.martin@email.com\",\n        \"primera_visita\": true,\n        \"seguro\": \"Ninguno\"\n      },\n      \"fecha\": \"2025-10-09\",\n      \"hora\": \"16:30\",\n      \"doctor\": \"Dra. Ana Mart√≠nez\",\n      \"motivo\": \"Consulta ortodoncia - Invisalign\",\n      \"estado\": \"confirmada\",\n      \"duracion_minutos\": 60,\n      \"notas\": \"Interesada en alineadores invisibles\"\n    }\n  ],\n\n  \"preguntas_frecuentes\": [\n    {\n      \"pregunta\": \"¬øDuele ponerse implantes dentales?\",\n      \"respuesta\": \"El procedimiento se realiza con anestesia local, por lo que no sentir√°s dolor durante la cirug√≠a. Despu√©s puede haber molestias leves que se controlan con analg√©sicos comunes. La mayor√≠a de pacientes reportan menos molestias de las que esperaban.\"\n    },\n    {\n      \"pregunta\": \"¬øCu√°nto dura un tratamiento de ortodoncia?\",\n      \"respuesta\": \"Depende de cada caso. Los tratamientos con brackets suelen durar entre 18-24 meses. Invisalign puede ser m√°s r√°pido, entre 12-18 meses en casos moderados. En la primera visita te daremos un tiempo estimado espec√≠fico para tu caso.\"\n    },\n    {\n      \"pregunta\": \"¬øAcept√°is pagos a plazos?\",\n      \"respuesta\": \"S√≠, ofrecemos financiaci√≥n sin intereses hasta 24 meses para tratamientos desde 600‚Ç¨. Tambi√©n trabajamos con financieras para plazos m√°s largos. Consultamos las mejores opciones para ti.\"\n    },\n    {\n      \"pregunta\": \"¬øHac√©is urgencias?\",\n      \"respuesta\": \"S√≠, reservamos huecos cada d√≠a para urgencias. Si tienes dolor intenso, traumatismo o infecci√≥n, ll√°manos y te atenderemos el mismo d√≠a. Fuera de horario, tenemos l√≠nea de urgencias 24h: +34 666 789 012\"\n    },\n    {\n      \"pregunta\": \"¬øTrabaj√°is con seguros m√©dicos?\",\n      \"respuesta\": \"S√≠, trabajamos con Sanitas, Adeslas, Asisa, DKV y Cigna. Dependiendo de tu p√≥liza, algunos tratamientos pueden estar totalmente cubiertos y otros con descuentos significativos.\"\n    }\n  ],\n\n  \"mensajes_automaticos\": {\n    \"confirmacion_cita\": \"¬°Hola {nombre}! ‚úÖ Tu cita en Cl√≠nica Dental Sonrisas est√° confirmada:\\nüìÖ {fecha} a las {hora}\\nüë®‚Äç‚öïÔ∏è Con {doctor}\\nüìç C/ Serrano 45, Madrid\\n\\n¬øAlguna duda? Ll√°manos al 915 123 456\",\n    \n    \"recordatorio_24h\": \"¬°Hola {nombre}! ü¶∑ Te recordamos tu cita ma√±ana {fecha} a las {hora} con {doctor}.\\n\\nPor favor, llega 10 minutos antes.\\n\\n¬øNecesitas cancelar? Ll√°manos al 915 123 456\",\n    \n    \"cancelacion\": \"Tu cita del {fecha} a las {hora} ha sido cancelada correctamente. ¬øQuieres reagendar? Ll√°manos al 915 123 456 o escr√≠benos.\",\n    \n    \"bienvenida_nuevo_paciente\": \"¬°Bienvenido a Cl√≠nica Dental Sonrisas! üòä Tu primera visita es GRATUITA e incluye revisi√≥n completa y diagn√≥stico. Estamos en C/ Serrano 45. ¬°Te esperamos!\",\n    \n    \"post_cita\": \"¬°Gracias por visitarnos! Esperamos que tu experiencia haya sido excelente. Si tienes cualquier molestia o pregunta, no dudes en contactarnos. ¬°Nos vemos pronto! üòäü¶∑\"\n  },\n\n  \"metadata\": {\n    \"ultima_actualizacion\": \"2025-10-06\",\n    \"version_base_datos\": \"1.0\",\n    \"total_servicios\": 15,\n    \"total_doctores\": 5,\n    \"idiomas_atencion\": [\"Espa√±ol\", \"Ingl√©s\", \"Franc√©s\", \"Portugu√©s\"]\n  }\n}",
          "options": {}
        },
        "type": "@n8n/n8n-nodes-langchain.agentTool",
        "typeVersion": 2.2,
        "position": [
          2080,
          208
        ],
        "id": "bdfa46fb-22f1-4ea8-bdb4-8ac2e844af6f",
        "name": "AI Agent base datos"
      },
      {
        "parameters": {
          "model": {
            "__rl": true,
            "mode": "list",
            "value": "gpt-4.1-mini"
          },
          "options": {}
        },
        "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
        "typeVersion": 1.2,
        "position": [
          2096,
          384
        ],
        "id": "b37f7d82-9857-4a72-bc5f-6ba407a227b5",
        "name": "OpenAI Chat Model1",
        "credentials": {}
      },
      {
        "parameters": {
          "sendTo": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('To', ``, 'string') }}",
          "subject": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('Subject', ``, 'string') }}",
          "emailType": "text",
          "message": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('Message', ``, 'string') }}",
          "options": {
            "appendAttribution": false
          }
        },
        "type": "n8n-nodes-base.gmailTool",
        "typeVersion": 2.1,
        "position": [
          1584,
          400
        ],
        "id": "133328ef-2c9d-4e1e-9dcc-0ce20e0ab6e7",
        "name": "Send a message in Gmail",
        "webhookId": "REDACTED",
        "credentials": {}
      },
      {
        "parameters": {
          "httpMethod": "POST",
          "path": "calidax",
          "options": {}
        },
        "type": "n8n-nodes-base.webhook",
        "typeVersion": 2.1,
        "position": [
          -1904,
          32
        ],
        "id": "3589ec19-18a6-4d14-999b-65e1e47fa49c",
        "name": "Webhook",
        "webhookId": "REDACTED"
      },
      {
        "parameters": {
          "jsCode": "// Obtener fecha actual en zona horaria de Madrid\nconst ahora = new Date();\n\n// Convertir a zona horaria de Madrid (Europe/Madrid)\nconst fechaMadrid = new Date(ahora.toLocaleString('en-US', { timeZone: 'Europe/Madrid' }));\n\n// Arrays en espa√±ol\nconst diasSemana = ['domingo', 'lunes', 'martes', 'mi√©rcoles', 'jueves', 'viernes', 's√°bado'];\nconst meses = ['enero', 'febrero', 'marzo', 'abril', 'mayo', 'junio', \n               'julio', 'agosto', 'septiembre', 'octubre', 'noviembre', 'diciembre'];\n\n// Extraer componentes de la fecha en Madrid\nconst diaSemana = diasSemana[fechaMadrid.getDay()];\nconst dia = fechaMadrid.getDate();\nconst mes = meses[fechaMadrid.getMonth()];\nconst anio = fechaMadrid.getFullYear();\nconst hora = String(fechaMadrid.getHours()).padStart(2, '0');\nconst minutos = String(fechaMadrid.getMinutes()).padStart(2, '0');\n\n// Construir la fecha en formato espa√±ol completo\nconst fechaActual = diaSemana + ' ' + dia + ' de ' + mes + ' de ' + anio + ', ' + hora + ':' + minutos;\n\n// Retornar el resultado\nreturn {\n  fechaActual: fechaActual\n};"
        },
        "type": "n8n-nodes-base.code",
        "typeVersion": 2,
        "position": [
          1248,
          -32
        ],
        "id": "53243e58-7e18-4183-844c-03dff425617a",
        "name": "Code in JavaScript"
      },
      {
        "parameters": {
          "jsCode": "let remoteJid = $('Edit Fields').first().json.chat_id;\n\nlet newValue;\n\nif (remoteJid === '237412974375033@lid') {\n  newValue = '56971357546@s.whatsapp.net';\n} else if (remoteJid === '31684007297203@lid') {\n  newValue = '56994359766@s.whatsapp.net';\n} else if (remoteJid === '19280175333491@lid') {\n  // Transformaci√≥n para +56 9 8471 0505\n  newValue = '56984710505@s.whatsapp.net';\n} else {\n  newValue = remoteJid;\n}\n\nreturn [{\n  json: {\n    chat_id: newValue\n  }\n}];\n"
        },
        "type": "n8n-nodes-base.code",
        "typeVersion": 2,
        "position": [
          1952,
          -32
        ],
        "id": "a4b4a5e2-704e-4c34-86e5-a4b72f4502c1",
        "name": "Code in JavaScript1"
      },
      {
        "parameters": {
          "operation": "push",
          "list": "={{ $('Edit Fields').item.json.chat_id }}",
          "messageData": "={{ $json.mensajeAudioOTexto }}",
          "tail": true
        },
        "type": "n8n-nodes-base.redis",
        "typeVersion": 1,
        "position": [
          -16,
          -16
        ],
        "id": "611bebcc-3ba1-483a-91ab-d0e556f663b8",
        "name": "Redis",
        "credentials": {}
      },
      {
        "parameters": {
          "operation": "get",
          "propertyName": "message",
          "key": "={{ $('Edit Fields').item.json.chat_id }}",
          "options": {}
        },
        "type": "n8n-nodes-base.redis",
        "typeVersion": 1,
        "position": [
          416,
          -16
        ],
        "id": "1cfb0b87-2fef-448a-9026-521c170e3ac6",
        "name": "Redis3",
        "credentials": {}
      },
      {
        "parameters": {
          "operation": "delete",
          "key": "={{ $('Edit Fields').item.json.chat_id }}"
        },
        "type": "n8n-nodes-base.redis",
        "typeVersion": 1,
        "position": [
          1104,
          -32
        ],
        "id": "dfa9061a-65f6-4fc5-9a13-2f2c7e2db135",
        "name": "Redis4",
        "credentials": {}
      },
      {
        "parameters": {
          "resource": "chat-api",
          "operation": "get-media-base64",
          "instanceName": "calidaxBot",
          "messageId": "={{ $('Webhook').item.json.body.data.key.id }}"
        },
        "type": "n8n-nodes-evolution-api.evolutionApi",
        "typeVersion": 1,
        "position": [
          -1520,
          304
        ],
        "id": "98d4e7b1-f104-4395-9d1a-c6a604481b7c",
        "name": "Obter m dia em base",
        "credentials": {}
      },
      {
        "parameters": {
          "operation": "toBinary",
          "sourceProperty": "data.base64",
          "options": {
            "mimeType": "={{ $('Webhook').item.json.body.data.message.imageMessage.mimetype }}"
          }
        },
        "type": "n8n-nodes-base.convertToFile",
        "typeVersion": 1.1,
        "position": [
          -1344,
          304
        ],
        "id": "07865e20-cfe2-47ce-8557-7263efd45848",
        "name": "Convert to File1"
      },
      {
        "parameters": {
          "resource": "image",
          "operation": "analyze",
          "modelId": {
            "__rl": true,
            "value": "gpt-4o-mini",
            "mode": "list",
            "cachedResultName": "GPT-4O-MINI"
          },
          "text": "Describe la imagen",
          "inputType": "base64",
          "options": {}
        },
        "type": "@n8n/n8n-nodes-langchain.openAi",
        "typeVersion": 1.8,
        "position": [
          -1152,
          304
        ],
        "id": "b0b0592f-d5a1-480f-9e14-650854559d0f",
        "name": "Analyze image",
        "credentials": {}
      },
      {
        "parameters": {
          "assignments": {
            "assignments": [
              {
                "id": "117de225-3973-45e8-883f-4830afd55bbd",
                "name": "content",
                "value": "=<image>\n{{ $json.content }}\n</image>",
                "type": "string"
              }
            ]
          },
          "options": {}
        },
        "type": "n8n-nodes-base.set",
        "typeVersion": 3.4,
        "position": [
          -928,
          304
        ],
        "id": "01da2f5b-c733-4153-b0bb-8fe3ba4b9b2a",
        "name": "Edit Fields2"
      }
    ],
    "connections": {
      "Edit Fields": {
        "main": [
          [
            {
              "node": "Switch",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Switch": {
        "main": [
          [
            {
              "node": "es mandado por el cliente",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "Mapear mensaje",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "Obter m dia em base",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "AI Agent1": {
        "main": [
          [
            {
              "node": "Code in JavaScript1",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Transcribir audio": {
        "main": [
          [
            {
              "node": "Mapear mensaje",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Mapear mensaje": {
        "main": [
          [
            {
              "node": "If2",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Switch1": {
        "main": [
          [
            {
              "node": "Redis",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Convert to File": {
        "main": [
          [
            {
              "node": "Transcribir audio",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Obter m dia em base64": {
        "main": [
          [
            {
              "node": "Convert to File",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Postgres Chat Memory": {
        "ai_memory": [
          [
            {
              "node": "AI Agent1",
              "type": "ai_memory",
              "index": 0
            }
          ]
        ]
      },
      "OpenAI Chat Model": {
        "ai_languageModel": [
          [
            {
              "node": "AI Agent1",
              "type": "ai_languageModel",
              "index": 0
            }
          ]
        ]
      },
      "es mandado por el cliente": {
        "main": [
          [
            {
              "node": "Obter m dia em base64",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Wait": {
        "main": [
          [
            {
              "node": "Redis3",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "If": {
        "main": [
          [
            {
              "node": "pregunta_usuario",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "No Operation, do nothing",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "pregunta_usuario": {
        "main": [
          [
            {
              "node": "Redis4",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "If1": {
        "main": [
          [
            {
              "node": "Edit Fields",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "If2": {
        "main": [
          [],
          [
            {
              "node": "Switch1",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Create an event in Google Calendar": {
        "ai_tool": [
          [
            {
              "node": "AI Agent1",
              "type": "ai_tool",
              "index": 0
            }
          ]
        ]
      },
      "Delete an event in Google Calendar": {
        "ai_tool": [
          [
            {
              "node": "AI Agent1",
              "type": "ai_tool",
              "index": 0
            }
          ]
        ]
      },
      "Get many events in Google Calendar": {
        "ai_tool": [
          [
            {
              "node": "AI Agent1",
              "type": "ai_tool",
              "index": 0
            }
          ]
        ]
      },
      "AI Agent base datos": {
        "ai_tool": [
          [
            {
              "node": "AI Agent1",
              "type": "ai_tool",
              "index": 0
            }
          ]
        ]
      },
      "OpenAI Chat Model1": {
        "ai_languageModel": [
          [
            {
              "node": "AI Agent base datos",
              "type": "ai_languageModel",
              "index": 0
            }
          ]
        ]
      },
      "Send a message in Gmail": {
        "ai_tool": [
          [
            {
              "node": "AI Agent1",
              "type": "ai_tool",
              "index": 0
            }
          ]
        ]
      },
      "Webhook": {
        "main": [
          [
            {
              "node": "If1",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Code in JavaScript": {
        "main": [
          [
            {
              "node": "AI Agent1",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Code in JavaScript1": {
        "main": [
          [
            {
              "node": "Enviar texto",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Redis": {
        "main": [
          [
            {
              "node": "Wait",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Redis3": {
        "main": [
          [
            {
              "node": "If",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Redis4": {
        "main": [
          [
            {
              "node": "Code in JavaScript",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Obter m dia em base": {
        "main": [
          [
            {
              "node": "Convert to File1",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Convert to File1": {
        "main": [
          [
            {
              "node": "Analyze image",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Analyze image": {
        "main": [
          [
            {
              "node": "Edit Fields2",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Edit Fields2": {
        "main": [
          [
            {
              "node": "Mapear mensaje",
              "type": "main",
              "index": 0
            }
          ]
        ]
      }
    },
    "authors": "abdelilah  idrissi",
    "name": null,
    "description": null
  },
  "activeVersionId": "a08ed1ac-e202-443c-9f00-f8811681ff65",
  "connections": {
    "Edit Fields": {
      "main": [
        [
          {
            "node": "Switch",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Switch": {
      "main": [
        [
          {
            "node": "es mandado por el cliente",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Mapear mensaje",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Obter m dia em base",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "AI Agent1": {
      "main": [
        [
          {
            "node": "Code in JavaScript1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Transcribir audio": {
      "main": [
        [
          {
            "node": "Mapear mensaje",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Mapear mensaje": {
      "main": [
        [
          {
            "node": "If2",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Switch1": {
      "main": [
        [
          {
            "node": "Redis",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Convert to File": {
      "main": [
        [
          {
            "node": "Transcribir audio",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Obter m dia em base64": {
      "main": [
        [
          {
            "node": "Convert to File",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Postgres Chat Memory": {
      "ai_memory": [
        [
          {
            "node": "AI Agent1",
            "type": "ai_memory",
            "index": 0
          }
        ]
      ]
    },
    "OpenAI Chat Model": {
      "ai_languageModel": [
        [
          {
            "node": "AI Agent1",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "es mandado por el cliente": {
      "main": [
        [
          {
            "node": "Obter m dia em base64",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Wait": {
      "main": [
        [
          {
            "node": "Redis3",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "If": {
      "main": [
        [
          {
            "node": "pregunta_usuario",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "No Operation, do nothing",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "pregunta_usuario": {
      "main": [
        [
          {
            "node": "Redis4",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "If1": {
      "main": [
        [
          {
            "node": "Edit Fields",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "If2": {
      "main": [
        [],
        [
          {
            "node": "Switch1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Create an event in Google Calendar": {
      "ai_tool": [
        [
          {
            "node": "AI Agent1",
            "type": "ai_tool",
            "index": 0
          }
        ]
      ]
    },
    "Delete an event in Google Calendar": {
      "ai_tool": [
        [
          {
            "node": "AI Agent1",
            "type": "ai_tool",
            "index": 0
          }
        ]
      ]
    },
    "Get many events in Google Calendar": {
      "ai_tool": [
        [
          {
            "node": "AI Agent1",
            "type": "ai_tool",
            "index": 0
          }
        ]
      ]
    },
    "AI Agent base datos": {
      "ai_tool": [
        [
          {
            "node": "AI Agent1",
            "type": "ai_tool",
            "index": 0
          }
        ]
      ]
    },
    "OpenAI Chat Model1": {
      "ai_languageModel": [
        [
          {
            "node": "AI Agent base datos",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "Send a message in Gmail": {
      "ai_tool": [
        [
          {
            "node": "AI Agent1",
            "type": "ai_tool",
            "index": 0
          }
        ]
      ]
    },
    "Webhook": {
      "main": [
        [
          {
            "node": "If1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Code in JavaScript": {
      "main": [
        [
          {
            "node": "AI Agent1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Code in JavaScript1": {
      "main": [
        [
          {
            "node": "Enviar texto",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Redis": {
      "main": [
        [
          {
            "node": "Wait",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Redis3": {
      "main": [
        [
          {
            "node": "If",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Redis4": {
      "main": [
        [
          {
            "node": "Code in JavaScript",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Obter m dia em base": {
      "main": [
        [
          {
            "node": "Convert to File1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Convert to File1": {
      "main": [
        [
          {
            "node": "Analyze image",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Analyze image": {
      "main": [
        [
          {
            "node": "Edit Fields2",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Edit Fields2": {
      "main": [
        [
          {
            "node": "Mapear mensaje",
            "type": "main",
            "index": 0
          }
        ]
      ]
    }
  },
  "createdAt": "2025-10-06T14:04:18.415Z",
  "id": "5baZQi4nBrmXGEH1",
  "isArchived": false,
  "meta": {
    "templateCredsSetupCompleted": true
  },
  "name": "asistente clinicas",
  "nodes": [
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "04868508-eb27-4b67-9dae-c883d48466d4",
              "name": "chat_id",
              "value": "={{ $json.body.data.key.remoteJid }}",
              "type": "string"
            },
            {
              "id": "48144532-1f21-4490-93e4-f6eeb2dfaa40",
              "name": "instance_name",
              "value": "={{ $json.body.instance }}",
              "type": "string"
            },
            {
              "id": "4073cc89-9702-4346-b6c2-7e619ee6f55d",
              "name": "api_key",
              "value": "[REDACTED]",
              "type": "string"
            },
            {
              "id": "a78a3578-e487-4dc4-bdc0-6e35e3df7013",
              "name": "url_server",
              "value": "={{ $json.body.server_url }}",
              "type": "string"
            },
            {
              "id": "005d7505-414e-42d0-ba75-390a2718043a",
              "name": "textoMensaje",
              "value": "={{ $json.body.data.message.conversation }}",
              "type": "string"
            },
            {
              "id": "b283725a-b70b-4324-8441-b5c1622e5e55",
              "name": "sessionKey",
              "value": "={{ $json.body.data.key.remoteJid }}",
              "type": "string"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        -1088,
        16
      ],
      "id": "1e24e1a0-83f4-42cf-a347-f1ccad7646c1",
      "name": "Edit Fields"
    },
    {
      "parameters": {
        "promptType": "define",
        "text": "={{ $('Redis4').item.json.response }}",
        "options": {
          "systemMessage": "=Eres el asistente virtual de **Cl√≠nica Dental Sonrisas**, una cl√≠nica dental moderna y profesional ubicada en Madrid. \n\nTu nombre es \"Sof√≠a\" y tu funci√≥n es atender a los pacientes de manera c√°lida, profesional y eficiente. \n\nPuedes leer mensajes o escuchar audios de los clientes.\n\n---\n\n## Tu Personalidad y Tono\n\n- Eres amable, emp√°tica y profesional\n- Usas un tono cercano pero respetuoso (tuteo amable)\n- Eres paciente y comprensiva, especialmente con personas que tienen ansiedad dental\n- Respondes de manera clara y concisa\n- Nunca proporcionas diagn√≥sticos m√©dicos, solo informaci√≥n general\n\n---\n\n## Tus Capacidades\n\n### 1. GESTI√ìN DE CITAS\n\n- Consultar disponibilidad de citas\n- Agendar nuevas citas (recoger: nombre completo, tel√©fono, email, motivo, fecha/hora preferida)\n- Modificar citas existentes\n- Cancelar citas (solicitar n√∫mero de cita o datos del paciente)\n- Enviar recordatorios\n\n### 2. INFORMACI√ìN DE SERVICIOS\n\nPuedes informar sobre estos tratamientos:\n\n- **Odontolog√≠a General**: Limpiezas, empastes, extracciones\n- **Est√©tica Dental**: Blanqueamiento, carillas, dise√±o de sonrisa\n- **Ortodoncia**: Brackets met√°licos, brackets est√©ticos, Invisalign\n- **Implantolog√≠a**: Implantes dentales, pr√≥tesis sobre implantes\n- **Endodoncia**: Tratamientos de conducto\n- **Periodoncia**: Tratamiento de enc√≠as\n- **Odontopediatr√≠a**: Atenci√≥n dental para ni√±os\n- **Cirug√≠a Oral**: Extracciones complejas, muelas del juicio\n\n### 3. INFORMACI√ìN GENERAL\n\n- **Horarios**: Lunes a Viernes 9:00-20:00, S√°bados 9:00-14:00\n- **Ubicaci√≥n**: Calle Serrano 45, 28006 Madrid\n- **Tel√©fono**: +34 915 123 456\n- **Email**: info@clinicasonrisas.es\n- **Seguros m√©dicos**: Sanitas, Adeslas, Asisa, DKV\n- **Primera visita GRATUITA** (incluye revisi√≥n y diagn√≥stico)\n\n### 4. PRECIOS Y PRESUPUESTOS\n\n- Proporciona rangos de precios generales\n- Para presupuestos espec√≠ficos, agenda una cita de valoraci√≥n gratuita\n- Informa sobre opciones de financiaci√≥n disponibles (hasta 24 meses sin intereses)\n\n### 5. URGENCIAS\n\n- Identifica urgencias dentales: dolor intenso, traumatismo, sangrado abundante\n- Para urgencias: ofrecer cita el mismo d√≠a o derivar a urgencias si es fuera de horario\n- **L√≠nea de urgencias 24h**: +34 666 789 012\n\n---\n\n## Flujo de Conversaci√≥n\n\n### Al Inicio\n\n1. Saluda cordialmente\n2. Pregunta en qu√© puedes ayudar\n3. Identifica la necesidad del paciente\n\n### Durante la Conversaci√≥n\n\n1. Haz preguntas espec√≠ficas para entender mejor la necesidad\n2. Proporciona informaci√≥n clara y relevante\n3. Si vas a agendar cita, recopila TODOS los datos necesarios\n4. Confirma la informaci√≥n antes de finalizar\n\n### Al Finalizar\n\n1. Resume lo acordado (especialmente si agendaste cita)\n2. Pregunta si necesita algo m√°s\n3. Desp√≠dete de manera c√°lida\n4. Si agendaste cita, menciona que recibir√° confirmaci√≥n por email/SMS\n\n---\n\n## Casos Especiales\n\n**Si el paciente pregunta por un dentista espec√≠fico:**\n- Consulta la base de datos de profesionales\n- Informa disponibilidad del doctor/a solicitado\n\n**Si el paciente tiene ansiedad dental:**\n- S√© extra emp√°tica\n- Menciona que ofrecemos sedaci√≥n consciente\n- Resalta que nuestros doctores son muy delicados\n\n**Si el paciente pregunta por un tratamiento que no conoces:**\n- No inventes informaci√≥n\n- Ofrece agendar una cita de valoraci√≥n gratuita con el especialista\n\n**Si detectas una urgencia:**\n- Prioriza la atenci√≥n\n- Ofrece el hueco m√°s cercano posible\n- Si es fuera de horario, da el n√∫mero de urgencias 24h\n\n---\n\n## Restricciones IMPORTANTES\n\n‚ùå NUNCA diagnostiques condiciones m√©dicas  \n‚ùå NUNCA recomiendes medicamentos espec√≠ficos  \n‚ùå NUNCA confirmes una cita sin tener TODOS los datos necesarios  \n‚ùå NUNCA des informaci√≥n sobre historiales m√©dicos de pacientes  \n‚ùå NUNCA proceses pagos (deriva a recepci√≥n)\n\n---\n\n## Datos que SIEMPRE debes recopilar para agendar cita\n\nPregunta UNA POR UNA, esperando la respuesta antes de continuar:\n\n1. Nombre completo\n2. Tel√©fono de contacto\n3. Email\n4. Motivo de la consulta\n5. Fecha preferida y Hora preferida (dentro del horario: Lunes a Viernes 9:00-20:00, S√°bados 9:00-14:00)\n6. ¬øEs primera visita?\n7. ¬øTiene seguro m√©dico? ¬øCu√°l?\n\n---\n\n## Proceso OBLIGATORIO despu√©s de agendar la cita\n\nUna vez que hayas recopilado TODOS los datos y confirmado la cita con el paciente:\n\n1. **ENV√çA INMEDIATAMENTE un email de confirmaci√≥n** al email proporcionado por el paciente usando la tool 'Send a message in Gmail'\n\n2. El email debe incluir:\n   - Fecha y hora de la cita\n   - Motivo de la consulta\n   - Nombre del paciente\n   - Datos de contacto de la cl√≠nica\n   - Recordatorio de llegar 10 minutos antes\n\n3. **Despu√©s de enviar el email**, informa al paciente que ya le has enviado la confirmaci√≥n\n\n---\n\n## Formato de Respuesta - REGLAS CR√çTICAS\n\n### Reglas de formato OBLIGATORIAS:\n\n- Usa p√°rrafos cortos y f√°ciles de leer\n- **NUNCA escribas bloques de texto largos sin saltos de l√≠nea**\n- Para listas de informaci√≥n (precios, servicios, horarios), usa SIEMPRE vi√±etas o bullets (-)\n- Usa emojis ocasionalmente para ser m√°s cercana (üòä ü¶∑ üìÖ)\n- Si proporcionas listas, hazlas claras y organizadas con bullets\n- Incluye calls-to-action claros (\"¬øTe gustar√≠a que agenda una cita?\")\n- **IMPORTANTE: Usa saltos de l√≠nea entre oraciones para mejor legibilidad**\n- **Separa ideas diferentes en p√°rrafos distintos**\n\n---\n\n## Ejemplos de Respuestas Bien Formateadas\n\n### Ejemplo 1 - Despedida:\n\n```\n¬°De nada! üòä\n\nHa sido un placer ayudarte.\n\nTe esperamos en Cl√≠nica Dental Sonrisas el viernes a las 11:00.\n\nCu√≠date mucho y que tengas un excelente d√≠a.\n\n¬°Hasta pronto! ü¶∑\n```\n\n### Ejemplo 2 - Lista de servicios:\n\n```\nClaro, te cuento los servicios que ofrecemos en Cl√≠nica Dental Sonrisas:\n\n- Odontolog√≠a General: Limpiezas, empastes, extracciones\n- Est√©tica Dental: Blanqueamiento, carillas, dise√±o de sonrisa\n- Ortodoncia: Brackets met√°licos, brackets est√©ticos, Invisalign\n- Implantolog√≠a: Implantes dentales, pr√≥tesis sobre implantes\n- Endodoncia: Tratamientos de conducto\n- Periodoncia: Tratamiento de enc√≠as\n- Odontopediatr√≠a: Atenci√≥n dental para ni√±os\n- Cirug√≠a Oral: Extracciones complejas, muelas del juicio\n\n¬øHay alg√∫n tratamiento que te interese en particular o quieres que te ayude a agendar una cita de valoraci√≥n? üòä\n```\n\n### Ejemplo 3 - Precios:\n\n```\nLos precios pueden variar seg√∫n el tratamiento, pero para darte una idea general:\n\n- Limpieza dental: entre 40 y 80 euros\n- Empastes: desde 60 euros\n- Blanqueamiento dental: de 150 a 300 euros\n- Ortodoncia brackets met√°licos: a partir de 1.500 euros\n- Invisalign: desde 3.000 euros\n- Implantes dentales: alrededor de 1.200 a 1.800 euros por implante\n\nPara un presupuesto exacto y detallado, te recomiendo agendar una cita de valoraci√≥n gratuita con nuestro especialista.\n\nAdem√°s, contamos con opciones de financiaci√≥n hasta 24 meses sin intereses.\n\n¬øQuieres que te ayude a reservar tu cita? üìÖ\n```\n\n### Ejemplo 4 - Confirmaci√≥n de cita:\n\n```\nPerfecto, Abde.\n\nTe confirmo tu cita:\n\nüìÖ Fecha: Viernes 31 de octubre\nüïê Hora: 11:00 h\nü¶∑ Motivo: Limpieza dental\n‚úÖ Primera visita: S√≠\nüí≥ Seguro m√©dico: No\n\nRecibir√°s una confirmaci√≥n por email y un recordatorio antes de la cita.\n\n¬øQuieres que te ayude con algo m√°s? üòä\n```\n\n---\n\n## Herramientas Disponibles\n\nPara acceder a la base de datos, usa el AI agent \"base de datos\" como tool.\n\nLa fecha de hoy es {{ $json.fechaActual }}\n\n---\n\n## Recordatorio Final\n\nTu objetivo es hacer que cada interacci√≥n sea positiva, eficiente y que el paciente se sienta bien atendido y con ganas de visitar nuestra cl√≠nica. \n\n¬°Eres la primera impresi√≥n de Cl√≠nica Dental Sonrisas! ü¶∑‚ú®\n```\n\nEste prompt ahora est√° mucho mejor estructurado con:[1][5]\n\n- **Secciones claramente separadas** con headers\n- **Listas con bullets** para mejor legibilidad\n- **Separadores visuales** (---) entre secciones\n- **Ejemplos formateados** en bloques de c√≥digo\n- **√ânfasis visual** con negritas para puntos clave\n- **Emojis estrat√©gicos** para humanizar el tono\n"
        }
      },
      "type": "@n8n/n8n-nodes-langchain.agent",
      "typeVersion": 1.9,
      "position": [
        1472,
        -32
      ],
      "id": "410eccbc-9a76-4b72-ad45-4962286d990e",
      "name": "AI Agent1"
    },
    {
      "parameters": {
        "rules": {
          "values": [
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 2
                },
                "conditions": [
                  {
                    "leftValue": "={{ $('Webhook').item.json.body.data.message.audioMessage.mimetype }}",
                    "rightValue": "=audio/ogg; codecs=opus",
                    "operator": {
                      "type": "string",
                      "operation": "equals"
                    },
                    "id": "be9dbcd5-0882-4ce9-9822-305865fae492"
                  }
                ],
                "combinator": "and"
              },
              "renameOutput": true,
              "outputKey": "Audio"
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 2
                },
                "conditions": [
                  {
                    "id": "6a0ec742-7f93-4ea1-af39-35d410da1c1a",
                    "leftValue": "={{ $('Webhook').item.json.body.data.messageType }}",
                    "rightValue": "conversation",
                    "operator": {
                      "type": "string",
                      "operation": "equals",
                      "name": "filter.operator.equals"
                    }
                  }
                ],
                "combinator": "and"
              },
              "renameOutput": true,
              "outputKey": "Texto"
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 2
                },
                "conditions": [
                  {
                    "id": "355e579a-2bc2-4c36-af8e-cf3639cc07fa",
                    "leftValue": "={{ $('Webhook').item.json.body.data.messageType }}",
                    "rightValue": "imageMessage",
                    "operator": {
                      "type": "string",
                      "operation": "equals",
                      "name": "filter.operator.equals"
                    }
                  }
                ],
                "combinator": "and"
              },
              "renameOutput": true,
              "outputKey": "imagen"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.switch",
      "typeVersion": 3.2,
      "position": [
        -912,
        0
      ],
      "id": "18798a96-bb34-4fc8-aa5a-b9a744c78a88",
      "name": "Switch"
    },
    {
      "parameters": {
        "resource": "audio",
        "operation": "transcribe",
        "options": {
          "language": "es"
        }
      },
      "type": "@n8n/n8n-nodes-langchain.openAi",
      "typeVersion": 1.8,
      "position": [
        -896,
        -240
      ],
      "id": "4e2325d4-3801-49c4-b39d-7f57a8453d9d",
      "name": "Transcribir audio",
      "credentials": {},
      "notes": "los audios estan en espa√±ol"
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "defa1545-074d-4d6a-a21f-a95c2226995f",
              "name": "mensajeAudioOTexto",
              "value": "={{ $json.text || $('Webhook').item.json.body.data.message.conversation || $json.content }}",
              "type": "string"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        -528,
        -32
      ],
      "id": "14220fd6-55ab-4156-a78c-b38795ee3e81",
      "name": "Mapear mensaje"
    },
    {
      "parameters": {
        "rules": {
          "values": [
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 2
                },
                "conditions": [
                  {
                    "leftValue": "={{ $('Mapear mensaje').item.json.mensajeAudioOTexto }}",
                    "rightValue": "[null]",
                    "operator": {
                      "type": "string",
                      "operation": "notEquals"
                    },
                    "id": "ea1ce058-1302-4e81-9680-f70a12960a82"
                  }
                ],
                "combinator": "and"
              }
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.switch",
      "typeVersion": 3.2,
      "position": [
        -192,
        0
      ],
      "id": "2e878e36-42ac-4457-b804-84c12437ab9c",
      "name": "Switch1"
    },
    {
      "parameters": {
        "operation": "toBinary",
        "sourceProperty": "data.base64",
        "options": {
          "mimeType": "audio/mp3"
        }
      },
      "type": "n8n-nodes-base.convertToFile",
      "typeVersion": 1.1,
      "position": [
        -1088,
        -240
      ],
      "id": "348546a2-a6f4-4c5f-8c45-5e56e5854e82",
      "name": "Convert to File"
    },
    {
      "parameters": {
        "resource": "chat-api",
        "operation": "get-media-base64",
        "instanceName": "calidaxBot",
        "messageId": "={{ $('Webhook').item.json.body.data.key.id }}"
      },
      "type": "n8n-nodes-evolution-api.evolutionApi",
      "typeVersion": 1,
      "position": [
        -1280,
        -240
      ],
      "id": "0e0ec54b-e84a-43b3-808b-fab1bda459f8",
      "name": "Obter m dia em base64",
      "credentials": {}
    },
    {
      "parameters": {
        "sessionIdType": "customKey",
        "sessionKey": "={{ $('Edit Fields').item.json.sessionKey }}"
      },
      "type": "@n8n/n8n-nodes-langchain.memoryPostgresChat",
      "typeVersion": 1.3,
      "position": [
        1360,
        400
      ],
      "id": "5b10fc91-76c5-49a8-b8e9-630891e4b395",
      "name": "Postgres Chat Memory",
      "credentials": {}
    },
    {
      "parameters": {
        "model": {
          "__rl": true,
          "mode": "list",
          "value": "gpt-4.1-mini"
        },
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
      "typeVersion": 1.2,
      "position": [
        1248,
        224
      ],
      "id": "771fe5d9-b94e-472d-824e-a3bef231e826",
      "name": "OpenAI Chat Model",
      "credentials": {}
    },
    {
      "parameters": {
        "rules": {
          "values": [
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 2
                },
                "conditions": [
                  {
                    "leftValue": "={{ $('Webhook').item.json.body.data.key.fromMe.toString() }}",
                    "rightValue": "=false",
                    "operator": {
                      "type": "string",
                      "operation": "equals"
                    },
                    "id": "84f1ac15-47a9-4f36-b8b0-73ea0edc3ecc"
                  }
                ],
                "combinator": "and"
              }
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.switch",
      "typeVersion": 3.2,
      "position": [
        -1520,
        -240
      ],
      "id": "904c9131-6b4a-4234-a77c-f613ac8c06a5",
      "name": "es mandado por el cliente"
    },
    {
      "parameters": {
        "amount": 1
      },
      "type": "n8n-nodes-base.wait",
      "typeVersion": 1.1,
      "position": [
        208,
        -16
      ],
      "id": "01c50c79-63f4-4d6b-a93c-74bd44f2e469",
      "name": "Wait",
      "webhookId": "REDACTED"
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict",
            "version": 2
          },
          "conditions": [
            {
              "id": "8ac5729a-0f8a-4564-b4f9-dd5e1fcb4c05",
              "leftValue": "={{ $json.message.last() }}",
              "rightValue": "={{ $('Mapear mensaje').item.json.mensajeAudioOTexto }}",
              "operator": {
                "type": "string",
                "operation": "equals",
                "name": "filter.operator.equals"
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.2,
      "position": [
        624,
        -16
      ],
      "id": "e30c0eb4-76c0-4570-aaf8-7ea8af539ae3",
      "name": "If"
    },
    {
      "parameters": {},
      "type": "n8n-nodes-base.noOp",
      "typeVersion": 1,
      "position": [
        928,
        288
      ],
      "id": "ebc7b712-0eb1-44de-bd71-6ae401a17303",
      "name": "No Operation, do nothing"
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "4a46e63b-2ead-4f35-aaa2-ab4ef5fc69f2",
              "name": "response",
              "value": "={{ $('Redis3').item.json.message }}",
              "type": "string"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        912,
        -32
      ],
      "id": "3f866252-6789-4cb5-8b5a-4986da43379b",
      "name": "pregunta_usuario"
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict",
            "version": 2
          },
          "conditions": [
            {
              "id": "641c492a-2026-49ba-81d8-31d19976fd99",
              "leftValue": "={{ $json.body.data.key.fromMe.toString() }}",
              "rightValue": "false",
              "operator": {
                "type": "string",
                "operation": "equals",
                "name": "filter.operator.equals"
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.2,
      "position": [
        -1728,
        32
      ],
      "id": "9c0b9346-5ca8-4fae-a138-8da9f767bf74",
      "name": "If1"
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict",
            "version": 2
          },
          "conditions": [
            {
              "id": "62cf7f96-e1f3-4350-850c-548e2291ed79",
              "leftValue": "={{ $('Webhook').item.json.body.data.key.remoteJid }}",
              "rightValue": "34641750559@s.whatsapp.net",
              "operator": {
                "type": "string",
                "operation": "equals",
                "name": "filter.operator.equals"
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.2,
      "position": [
        -352,
        -16
      ],
      "id": "3670b18a-113f-4f2b-ac92-e8088e606256",
      "name": "If2"
    },
    {
      "parameters": {
        "calendar": {
          "__rl": true,
          "value": "aimaspain.contacto@gmail.com",
          "mode": "list",
          "cachedResultName": "aimaspain.contacto@gmail.com"
        },
        "start": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('Start', ``, 'string') }}",
        "end": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('End', ``, 'string') }}",
        "useDefaultReminders": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('Use_Default_Reminders', ``, 'boolean') }}",
        "additionalFields": {
          "attendees": [
            "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('attendees0_Attendees', ``, 'string') }}",
            "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('attendees1_Attendees', ``, 'string') }}"
          ],
          "description": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('Description', ``, 'string') }}"
        }
      },
      "type": "n8n-nodes-base.googleCalendarTool",
      "typeVersion": 1.3,
      "position": [
        1968,
        384
      ],
      "id": "42fde3cc-8599-4f5e-8324-f066ad25b3cc",
      "name": "Create an event in Google Calendar",
      "credentials": {}
    },
    {
      "parameters": {
        "operation": "delete",
        "calendar": {
          "__rl": true,
          "value": "aimaspain.contacto@gmail.com",
          "mode": "list",
          "cachedResultName": "aimaspain.contacto@gmail.com"
        },
        "eventId": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('Event_ID', ``, 'string') }}",
        "options": {}
      },
      "type": "n8n-nodes-base.googleCalendarTool",
      "typeVersion": 1.3,
      "position": [
        1840,
        384
      ],
      "id": "fcd45152-33f5-441d-bbbf-0ab66ffc40c5",
      "name": "Delete an event in Google Calendar",
      "credentials": {}
    },
    {
      "parameters": {
        "operation": "getAll",
        "calendar": {
          "__rl": true,
          "value": "aimaspain.contacto@gmail.com",
          "mode": "list",
          "cachedResultName": "aimaspain.contacto@gmail.com"
        },
        "returnAll": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('Return_All', ``, 'boolean') }}",
        "timeMin": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('After', ``, 'string') }}",
        "timeMax": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('Before', ``, 'string') }}",
        "options": {}
      },
      "type": "n8n-nodes-base.googleCalendarTool",
      "typeVersion": 1.3,
      "position": [
        1744,
        384
      ],
      "id": "198c03c0-fcdb-49ae-9b82-83cf8e534a57",
      "name": "Get many events in Google Calendar",
      "credentials": {}
    },
    {
      "parameters": {
        "resource": "messages-api",
        "instanceName": "calidaxBot",
        "remoteJid": "={{ $('Code in JavaScript1').item.json.chat_id }}",
        "messageText": "={{ $('AI Agent1').item.json.output }}",
        "options_message": {}
      },
      "type": "n8n-nodes-evolution-api.evolutionApi",
      "typeVersion": 1,
      "position": [
        2432,
        -32
      ],
      "id": "07f0ea4e-245a-4b30-9960-ad73c85eae7c",
      "name": "Enviar texto",
      "credentials": {}
    },
    {
      "parameters": {
        "text": "=esta es tu base de datos:\n{\n  \"clinica\": {\n    \"nombre\": \"Cl√≠nica Dental Sonrisas\",\n    \"direccion\": \"Calle Serrano 45, 28006 Madrid\",\n    \"telefono\": \"+34 915 123 456\",\n    \"email\": \"info@clinicasonrisas.es\",\n    \"urgencias_24h\": \"+34 666 789 012\",\n    \"horarios\": {\n      \"lunes_viernes\": \"09:00 - 20:00\",\n      \"sabado\": \"09:00 - 14:00\",\n      \"domingo\": \"Cerrado\"\n    },\n    \"redes_sociales\": {\n      \"instagram\": \"@clinicasonrisas\",\n      \"facebook\": \"ClinicaDentalSonrisas\"\n    }\n  },\n\n  \"servicios\": [\n    {\n      \"id\": \"ODG001\",\n      \"categoria\": \"Odontolog√≠a General\",\n      \"nombre\": \"Limpieza Dental Profunda\",\n      \"descripcion\": \"Eliminaci√≥n de sarro y placa bacteriana con ultrasonido y pulido\",\n      \"duracion_minutos\": 45,\n      \"precio_desde\": 60,\n      \"precio_hasta\": 90\n    },\n    {\n      \"id\": \"ODG002\",\n      \"categoria\": \"Odontolog√≠a General\",\n      \"nombre\": \"Empaste Composite\",\n      \"descripcion\": \"Restauraci√≥n de caries con material est√©tico del color del diente\",\n      \"duracion_minutos\": 30,\n      \"precio_desde\": 50,\n      \"precio_hasta\": 100\n    },\n    {\n      \"id\": \"ODG003\",\n      \"categoria\": \"Odontolog√≠a General\",\n      \"nombre\": \"Extracci√≥n Simple\",\n      \"descripcion\": \"Extracci√≥n de pieza dental sin complicaciones\",\n      \"duracion_minutos\": 30,\n      \"precio_desde\": 50,\n      \"precio_hasta\": 80\n    },\n    {\n      \"id\": \"EST001\",\n      \"categoria\": \"Est√©tica Dental\",\n      \"nombre\": \"Blanqueamiento LED\",\n      \"descripcion\": \"Blanqueamiento dental profesional con tecnolog√≠a LED\",\n      \"duracion_minutos\": 60,\n      \"precio_desde\": 250,\n      \"precio_hasta\": 350\n    },\n    {\n      \"id\": \"EST002\",\n      \"categoria\": \"Est√©tica Dental\",\n      \"nombre\": \"Carillas de Porcelana\",\n      \"descripcion\": \"L√°minas de porcelana para transformar la sonrisa\",\n      \"duracion_minutos\": 120,\n      \"precio_desde\": 400,\n      \"precio_hasta\": 600,\n      \"precio_por\": \"pieza\"\n    },\n    {\n      \"id\": \"EST003\",\n      \"categoria\": \"Est√©tica Dental\",\n      \"nombre\": \"Dise√±o de Sonrisa Digital\",\n      \"descripcion\": \"Planificaci√≥n digital de tu nueva sonrisa con vista previa\",\n      \"duracion_minutos\": 60,\n      \"precio_desde\": 150,\n      \"precio_hasta\": 250\n    },\n    {\n      \"id\": \"ORT001\",\n      \"categoria\": \"Ortodoncia\",\n      \"nombre\": \"Brackets Met√°licos\",\n      \"descripcion\": \"Ortodoncia tradicional con brackets met√°licos\",\n      \"duracion_meses\": \"18-24\",\n      \"precio_desde\": 2500,\n      \"precio_hasta\": 3500,\n      \"incluye\": \"Estudio, brackets, revisiones mensuales, retenedores\"\n    },\n    {\n      \"id\": \"ORT002\",\n      \"categoria\": \"Ortodoncia\",\n      \"nombre\": \"Brackets Est√©ticos (Zafiro)\",\n      \"descripcion\": \"Brackets transparentes de zafiro, pr√°cticamente invisibles\",\n      \"duracion_meses\": \"18-24\",\n      \"precio_desde\": 3500,\n      \"precio_hasta\": 4500\n    },\n    {\n      \"id\": \"ORT003\",\n      \"categoria\": \"Ortodoncia\",\n      \"nombre\": \"Invisalign\",\n      \"descripcion\": \"Alineadores invisibles removibles, tratamiento digital\",\n      \"duracion_meses\": \"12-18\",\n      \"precio_desde\": 3800,\n      \"precio_hasta\": 5500\n    },\n    {\n      \"id\": \"IMP001\",\n      \"categoria\": \"Implantolog√≠a\",\n      \"nombre\": \"Implante Dental Unitario\",\n      \"descripcion\": \"Implante de titanio con corona de porcelana\",\n      \"duracion_meses\": \"3-6\",\n      \"precio_desde\": 1200,\n      \"precio_hasta\": 1800,\n      \"incluye\": \"Implante, pilar, corona, cirug√≠a\"\n    },\n    {\n      \"id\": \"IMP002\",\n      \"categoria\": \"Implantolog√≠a\",\n      \"nombre\": \"Pr√≥tesis Completa sobre 4 Implantes\",\n      \"descripcion\": \"Rehabilitaci√≥n completa de arcada con t√©cnica All-on-4\",\n      \"duracion_meses\": \"4-8\",\n      \"precio_desde\": 8000,\n      \"precio_hasta\": 12000\n    },\n    {\n      \"id\": \"END001\",\n      \"categoria\": \"Endodoncia\",\n      \"nombre\": \"Endodoncia (Matar Nervio)\",\n      \"descripcion\": \"Tratamiento de conductos radiculares para salvar la pieza\",\n      \"duracion_minutos\": 90,\n      \"precio_desde\": 200,\n      \"precio_hasta\": 400,\n      \"sesiones\": \"1-2\"\n    },\n    {\n      \"id\": \"PER001\",\n      \"categoria\": \"Periodoncia\",\n      \"nombre\": \"Tratamiento Periodontal Completo\",\n      \"descripcion\": \"Curetaje y raspado para tratar enfermedad de enc√≠as\",\n      \"duracion_minutos\": 60,\n      \"precio_desde\": 400,\n      \"precio_hasta\": 800,\n      \"sesiones\": \"2-4\"\n    },\n    {\n      \"id\": \"PED001\",\n      \"categoria\": \"Odontopediatr√≠a\",\n      \"nombre\": \"Revisi√≥n Dental Infantil\",\n      \"descripcion\": \"Revisi√≥n completa con fluorizaci√≥n para ni√±os\",\n      \"duracion_minutos\": 30,\n      \"precio_desde\": 30,\n      \"precio_hasta\": 50\n    },\n    {\n      \"id\": \"CIR001\",\n      \"categoria\": \"Cirug√≠a Oral\",\n      \"nombre\": \"Extracci√≥n Muelas del Juicio\",\n      \"descripcion\": \"Extracci√≥n quir√∫rgica de cordales impactados\",\n      \"duracion_minutos\": 45,\n      \"precio_desde\": 150,\n      \"precio_hasta\": 300,\n      \"precio_por\": \"pieza\"\n    }\n  ],\n\n  \"doctores\": [\n    {\n      \"id\": \"DOC001\",\n      \"nombre\": \"Dra. Mar√≠a Gonz√°lez\",\n      \"especialidad\": \"Directora / Odontolog√≠a General\",\n      \"experiencia_anos\": 15,\n      \"idiomas\": [\"Espa√±ol\", \"Ingl√©s\"],\n      \"horario_atencion\": [\"Lunes\", \"Martes\", \"Mi√©rcoles\", \"Viernes\"],\n      \"disponibilidad_ma√±ana\": true,\n      \"disponibilidad_tarde\": true\n    },\n    {\n      \"id\": \"DOC002\",\n      \"nombre\": \"Dr. Carlos Ram√≠rez\",\n      \"especialidad\": \"Implantolog√≠a y Cirug√≠a\",\n      \"experiencia_anos\": 20,\n      \"idiomas\": [\"Espa√±ol\", \"Franc√©s\"],\n      \"horario_atencion\": [\"Martes\", \"Jueves\", \"Viernes\"],\n      \"disponibilidad_ma√±ana\": true,\n      \"disponibilidad_tarde\": false\n    },\n    {\n      \"id\": \"DOC003\",\n      \"nombre\": \"Dra. Ana Mart√≠nez\",\n      \"especialidad\": \"Ortodoncia e Invisalign\",\n      \"experiencia_anos\": 12,\n      \"certificaciones\": [\"Invisalign Diamond Provider\"],\n      \"idiomas\": [\"Espa√±ol\", \"Ingl√©s\", \"Portugu√©s\"],\n      \"horario_atencion\": [\"Lunes\", \"Mi√©rcoles\", \"Jueves\", \"S√°bado\"],\n      \"disponibilidad_ma√±ana\": true,\n      \"disponibilidad_tarde\": true\n    },\n    {\n      \"id\": \"DOC004\",\n      \"nombre\": \"Dr. Javier L√≥pez\",\n      \"especialidad\": \"Est√©tica Dental\",\n      \"experiencia_anos\": 10,\n      \"idiomas\": [\"Espa√±ol\", \"Ingl√©s\"],\n      \"horario_atencion\": [\"Lunes\", \"Martes\", \"Mi√©rcoles\", \"Jueves\"],\n      \"disponibilidad_ma√±ana\": false,\n      \"disponibilidad_tarde\": true\n    },\n    {\n      \"id\": \"DOC005\",\n      \"nombre\": \"Dra. Laura S√°nchez\",\n      \"especialidad\": \"Odontopediatr√≠a\",\n      \"experiencia_anos\": 8,\n      \"idiomas\": [\"Espa√±ol\"],\n      \"horario_atencion\": [\"Martes\", \"Jueves\", \"Viernes\", \"S√°bado\"],\n      \"disponibilidad_ma√±ana\": true,\n      \"disponibilidad_tarde\": true,\n      \"nota\": \"Especializada en ni√±os con ansiedad dental\"\n    }\n  ],\n\n  \"seguros_aceptados\": [\n    {\n      \"nombre\": \"Sanitas Dental\",\n      \"cobertura\": \"80% tratamientos b√°sicos, 50% especialidades\",\n      \"copago_consulta\": 0\n    },\n    {\n      \"nombre\": \"Adeslas Dental\",\n      \"cobertura\": \"Sin copago en limpieza anual, descuentos en tratamientos\",\n      \"copago_consulta\": 0\n    },\n    {\n      \"nombre\": \"Asisa Dental\",\n      \"cobertura\": \"Cuadro m√©dico completo, sin copagos en prevenci√≥n\",\n      \"copago_consulta\": 0\n    },\n    {\n      \"nombre\": \"DKV Dentisalud\",\n      \"cobertura\": \"Reembolso de tratamientos seg√∫n baremo\",\n      \"copago_consulta\": 15\n    },\n    {\n      \"nombre\": \"Cigna Dental\",\n      \"cobertura\": \"Red de cl√≠nicas concertadas\",\n      \"copago_consulta\": 10\n    }\n  ],\n\n  \"promociones_actuales\": [\n    {\n      \"id\": \"PROMO001\",\n      \"titulo\": \"Primera Visita GRATIS\",\n      \"descripcion\": \"Revisi√≥n completa, radiograf√≠a panor√°mica y diagn√≥stico sin coste\",\n      \"vigencia\": \"Permanente\",\n      \"condiciones\": \"Solo nuevos pacientes\"\n    },\n    {\n      \"id\": \"PROMO002\",\n      \"titulo\": \"Blanqueamiento + Limpieza\",\n      \"descripcion\": \"Pack especial: Blanqueamiento LED + Limpieza profunda por 280‚Ç¨ (ahorra 80‚Ç¨)\",\n      \"precio_normal\": 360,\n      \"precio_promocion\": 280,\n      \"vigencia\": \"Hasta 31/12/2025\"\n    },\n    {\n      \"id\": \"PROMO003\",\n      \"titulo\": \"Financiaci√≥n 0% Intereses\",\n      \"descripcion\": \"Financia tu tratamiento hasta 24 meses sin intereses\",\n      \"importe_minimo\": 600,\n      \"vigencia\": \"Permanente\"\n    }\n  ],\n\n  \"horarios_disponibles_template\": {\n    \"lunes\": {\n      \"ma√±ana\": [\"09:00\", \"09:30\", \"10:00\", \"10:30\", \"11:00\", \"11:30\", \"12:00\", \"12:30\", \"13:00\"],\n      \"tarde\": [\"16:00\", \"16:30\", \"17:00\", \"17:30\", \"18:00\", \"18:30\", \"19:00\", \"19:30\"]\n    },\n    \"martes\": {\n      \"ma√±ana\": [\"09:00\", \"09:30\", \"10:00\", \"10:30\", \"11:00\", \"11:30\", \"12:00\", \"12:30\", \"13:00\"],\n      \"tarde\": [\"16:00\", \"16:30\", \"17:00\", \"17:30\", \"18:00\", \"18:30\", \"19:00\", \"19:30\"]\n    },\n    \"miercoles\": {\n      \"ma√±ana\": [\"09:00\", \"09:30\", \"10:00\", \"10:30\", \"11:00\", \"11:30\", \"12:00\", \"12:30\", \"13:00\"],\n      \"tarde\": [\"16:00\", \"16:30\", \"17:00\", \"17:30\", \"18:00\", \"18:30\", \"19:00\", \"19:30\"]\n    },\n    \"jueves\": {\n      \"ma√±ana\": [\"09:00\", \"09:30\", \"10:00\", \"10:30\", \"11:00\", \"11:30\", \"12:00\", \"12:30\", \"13:00\"],\n      \"tarde\": [\"16:00\", \"16:30\", \"17:00\", \"17:30\", \"18:00\", \"18:30\", \"19:00\", \"19:30\"]\n    },\n    \"viernes\": {\n      \"ma√±ana\": [\"09:00\", \"09:30\", \"10:00\", \"10:30\", \"11:00\", \"11:30\", \"12:00\", \"12:30\", \"13:00\"],\n      \"tarde\": [\"16:00\", \"16:30\", \"17:00\", \"17:30\", \"18:00\", \"18:30\", \"19:00\", \"19:30\"]\n    },\n    \"sabado\": {\n      \"ma√±ana\": [\"09:00\", \"09:30\", \"10:00\", \"10:30\", \"11:00\", \"11:30\", \"12:00\", \"12:30\", \"13:00\"],\n      \"tarde\": []\n    }\n  },\n\n  \"citas_ejemplo\": [\n    {\n      \"id_cita\": \"CITA2025001\",\n      \"paciente\": {\n        \"nombre\": \"Juan P√©rez Garc√≠a\",\n        \"telefono\": \"+34 612 345 678\",\n        \"email\": \"juan.perez@email.com\",\n        \"primera_visita\": false,\n        \"seguro\": \"Sanitas Dental\"\n      },\n      \"fecha\": \"2025-10-08\",\n      \"hora\": \"10:00\",\n      \"doctor\": \"Dra. Mar√≠a Gonz√°lez\",\n      \"motivo\": \"Limpieza dental\",\n      \"estado\": \"confirmada\",\n      \"duracion_minutos\": 45\n    },\n    {\n      \"id_cita\": \"CITA2025002\",\n      \"paciente\": {\n        \"nombre\": \"Laura Mart√≠n L√≥pez\",\n        \"telefono\": \"+34 654 987 321\",\n        \"email\": \"laura.martin@email.com\",\n        \"primera_visita\": true,\n        \"seguro\": \"Ninguno\"\n      },\n      \"fecha\": \"2025-10-09\",\n      \"hora\": \"16:30\",\n      \"doctor\": \"Dra. Ana Mart√≠nez\",\n      \"motivo\": \"Consulta ortodoncia - Invisalign\",\n      \"estado\": \"confirmada\",\n      \"duracion_minutos\": 60,\n      \"notas\": \"Interesada en alineadores invisibles\"\n    }\n  ],\n\n  \"preguntas_frecuentes\": [\n    {\n      \"pregunta\": \"¬øDuele ponerse implantes dentales?\",\n      \"respuesta\": \"El procedimiento se realiza con anestesia local, por lo que no sentir√°s dolor durante la cirug√≠a. Despu√©s puede haber molestias leves que se controlan con analg√©sicos comunes. La mayor√≠a de pacientes reportan menos molestias de las que esperaban.\"\n    },\n    {\n      \"pregunta\": \"¬øCu√°nto dura un tratamiento de ortodoncia?\",\n      \"respuesta\": \"Depende de cada caso. Los tratamientos con brackets suelen durar entre 18-24 meses. Invisalign puede ser m√°s r√°pido, entre 12-18 meses en casos moderados. En la primera visita te daremos un tiempo estimado espec√≠fico para tu caso.\"\n    },\n    {\n      \"pregunta\": \"¬øAcept√°is pagos a plazos?\",\n      \"respuesta\": \"S√≠, ofrecemos financiaci√≥n sin intereses hasta 24 meses para tratamientos desde 600‚Ç¨. Tambi√©n trabajamos con financieras para plazos m√°s largos. Consultamos las mejores opciones para ti.\"\n    },\n    {\n      \"pregunta\": \"¬øHac√©is urgencias?\",\n      \"respuesta\": \"S√≠, reservamos huecos cada d√≠a para urgencias. Si tienes dolor intenso, traumatismo o infecci√≥n, ll√°manos y te atenderemos el mismo d√≠a. Fuera de horario, tenemos l√≠nea de urgencias 24h: +34 666 789 012\"\n    },\n    {\n      \"pregunta\": \"¬øTrabaj√°is con seguros m√©dicos?\",\n      \"respuesta\": \"S√≠, trabajamos con Sanitas, Adeslas, Asisa, DKV y Cigna. Dependiendo de tu p√≥liza, algunos tratamientos pueden estar totalmente cubiertos y otros con descuentos significativos.\"\n    }\n  ],\n\n  \"mensajes_automaticos\": {\n    \"confirmacion_cita\": \"¬°Hola {nombre}! ‚úÖ Tu cita en Cl√≠nica Dental Sonrisas est√° confirmada:\\nüìÖ {fecha} a las {hora}\\nüë®‚Äç‚öïÔ∏è Con {doctor}\\nüìç C/ Serrano 45, Madrid\\n\\n¬øAlguna duda? Ll√°manos al 915 123 456\",\n    \n    \"recordatorio_24h\": \"¬°Hola {nombre}! ü¶∑ Te recordamos tu cita ma√±ana {fecha} a las {hora} con {doctor}.\\n\\nPor favor, llega 10 minutos antes.\\n\\n¬øNecesitas cancelar? Ll√°manos al 915 123 456\",\n    \n    \"cancelacion\": \"Tu cita del {fecha} a las {hora} ha sido cancelada correctamente. ¬øQuieres reagendar? Ll√°manos al 915 123 456 o escr√≠benos.\",\n    \n    \"bienvenida_nuevo_paciente\": \"¬°Bienvenido a Cl√≠nica Dental Sonrisas! üòä Tu primera visita es GRATUITA e incluye revisi√≥n completa y diagn√≥stico. Estamos en C/ Serrano 45. ¬°Te esperamos!\",\n    \n    \"post_cita\": \"¬°Gracias por visitarnos! Esperamos que tu experiencia haya sido excelente. Si tienes cualquier molestia o pregunta, no dudes en contactarnos. ¬°Nos vemos pronto! üòäü¶∑\"\n  },\n\n  \"metadata\": {\n    \"ultima_actualizacion\": \"2025-10-06\",\n    \"version_base_datos\": \"1.0\",\n    \"total_servicios\": 15,\n    \"total_doctores\": 5,\n    \"idiomas_atencion\": [\"Espa√±ol\", \"Ingl√©s\", \"Franc√©s\", \"Portugu√©s\"]\n  }\n}",
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.agentTool",
      "typeVersion": 2.2,
      "position": [
        2080,
        208
      ],
      "id": "bdfa46fb-22f1-4ea8-bdb4-8ac2e844af6f",
      "name": "AI Agent base datos"
    },
    {
      "parameters": {
        "model": {
          "__rl": true,
          "mode": "list",
          "value": "gpt-4.1-mini"
        },
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
      "typeVersion": 1.2,
      "position": [
        2096,
        384
      ],
      "id": "b37f7d82-9857-4a72-bc5f-6ba407a227b5",
      "name": "OpenAI Chat Model1",
      "credentials": {}
    },
    {
      "parameters": {
        "sendTo": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('To', ``, 'string') }}",
        "subject": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('Subject', ``, 'string') }}",
        "emailType": "text",
        "message": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('Message', ``, 'string') }}",
        "options": {
          "appendAttribution": false
        }
      },
      "type": "n8n-nodes-base.gmailTool",
      "typeVersion": 2.1,
      "position": [
        1584,
        400
      ],
      "id": "133328ef-2c9d-4e1e-9dcc-0ce20e0ab6e7",
      "name": "Send a message in Gmail",
      "webhookId": "REDACTED",
      "credentials": {}
    },
    {
      "parameters": {
        "httpMethod": "POST",
        "path": "calidax",
        "options": {}
      },
      "type": "n8n-nodes-base.webhook",
      "typeVersion": 2.1,
      "position": [
        -1904,
        32
      ],
      "id": "3589ec19-18a6-4d14-999b-65e1e47fa49c",
      "name": "Webhook",
      "webhookId": "REDACTED"
    },
    {
      "parameters": {
        "jsCode": "// Obtener fecha actual en zona horaria de Madrid\nconst ahora = new Date();\n\n// Convertir a zona horaria de Madrid (Europe/Madrid)\nconst fechaMadrid = new Date(ahora.toLocaleString('en-US', { timeZone: 'Europe/Madrid' }));\n\n// Arrays en espa√±ol\nconst diasSemana = ['domingo', 'lunes', 'martes', 'mi√©rcoles', 'jueves', 'viernes', 's√°bado'];\nconst meses = ['enero', 'febrero', 'marzo', 'abril', 'mayo', 'junio', \n               'julio', 'agosto', 'septiembre', 'octubre', 'noviembre', 'diciembre'];\n\n// Extraer componentes de la fecha en Madrid\nconst diaSemana = diasSemana[fechaMadrid.getDay()];\nconst dia = fechaMadrid.getDate();\nconst mes = meses[fechaMadrid.getMonth()];\nconst anio = fechaMadrid.getFullYear();\nconst hora = String(fechaMadrid.getHours()).padStart(2, '0');\nconst minutos = String(fechaMadrid.getMinutes()).padStart(2, '0');\n\n// Construir la fecha en formato espa√±ol completo\nconst fechaActual = diaSemana + ' ' + dia + ' de ' + mes + ' de ' + anio + ', ' + hora + ':' + minutos;\n\n// Retornar el resultado\nreturn {\n  fechaActual: fechaActual\n};"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        1248,
        -32
      ],
      "id": "53243e58-7e18-4183-844c-03dff425617a",
      "name": "Code in JavaScript"
    },
    {
      "parameters": {
        "jsCode": "let remoteJid = $('Edit Fields').first().json.chat_id;\n\nlet newValue;\n\nif (remoteJid === '237412974375033@lid') {\n  newValue = '56971357546@s.whatsapp.net';\n} else if (remoteJid === '31684007297203@lid') {\n  newValue = '56994359766@s.whatsapp.net';\n} else if (remoteJid === '19280175333491@lid') {\n  // Transformaci√≥n para +56 9 8471 0505\n  newValue = '56984710505@s.whatsapp.net';\n} else {\n  newValue = remoteJid;\n}\n\nreturn [{\n  json: {\n    chat_id: newValue\n  }\n}];\n"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        1952,
        -32
      ],
      "id": "a4b4a5e2-704e-4c34-86e5-a4b72f4502c1",
      "name": "Code in JavaScript1"
    },
    {
      "parameters": {
        "operation": "push",
        "list": "={{ $('Edit Fields').item.json.chat_id }}",
        "messageData": "={{ $json.mensajeAudioOTexto }}",
        "tail": true
      },
      "type": "n8n-nodes-base.redis",
      "typeVersion": 1,
      "position": [
        -16,
        -16
      ],
      "id": "611bebcc-3ba1-483a-91ab-d0e556f663b8",
      "name": "Redis",
      "credentials": {}
    },
    {
      "parameters": {
        "operation": "get",
        "propertyName": "message",
        "key": "={{ $('Edit Fields').item.json.chat_id }}",
        "options": {}
      },
      "type": "n8n-nodes-base.redis",
      "typeVersion": 1,
      "position": [
        416,
        -16
      ],
      "id": "1cfb0b87-2fef-448a-9026-521c170e3ac6",
      "name": "Redis3",
      "credentials": {}
    },
    {
      "parameters": {
        "operation": "delete",
        "key": "={{ $('Edit Fields').item.json.chat_id }}"
      },
      "type": "n8n-nodes-base.redis",
      "typeVersion": 1,
      "position": [
        1104,
        -32
      ],
      "id": "dfa9061a-65f6-4fc5-9a13-2f2c7e2db135",
      "name": "Redis4",
      "credentials": {}
    },
    {
      "parameters": {
        "resource": "chat-api",
        "operation": "get-media-base64",
        "instanceName": "calidaxBot",
        "messageId": "={{ $('Webhook').item.json.body.data.key.id }}"
      },
      "type": "n8n-nodes-evolution-api.evolutionApi",
      "typeVersion": 1,
      "position": [
        -1520,
        304
      ],
      "id": "98d4e7b1-f104-4395-9d1a-c6a604481b7c",
      "name": "Obter m dia em base",
      "credentials": {}
    },
    {
      "parameters": {
        "operation": "toBinary",
        "sourceProperty": "data.base64",
        "options": {
          "mimeType": "={{ $('Webhook').item.json.body.data.message.imageMessage.mimetype }}"
        }
      },
      "type": "n8n-nodes-base.convertToFile",
      "typeVersion": 1.1,
      "position": [
        -1344,
        304
      ],
      "id": "07865e20-cfe2-47ce-8557-7263efd45848",
      "name": "Convert to File1"
    },
    {
      "parameters": {
        "resource": "image",
        "operation": "analyze",
        "modelId": {
          "__rl": true,
          "value": "gpt-4o-mini",
          "mode": "list",
          "cachedResultName": "GPT-4O-MINI"
        },
        "text": "Describe la imagen",
        "inputType": "base64",
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.openAi",
      "typeVersion": 1.8,
      "position": [
        -1152,
        304
      ],
      "id": "b0b0592f-d5a1-480f-9e14-650854559d0f",
      "name": "Analyze image",
      "credentials": {}
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "117de225-3973-45e8-883f-4830afd55bbd",
              "name": "content",
              "value": "=<image>\n{{ $json.content }}\n</image>",
              "type": "string"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        -928,
        304
      ],
      "id": "01da2f5b-c733-4153-b0bb-8fe3ba4b9b2a",
      "name": "Edit Fields2"
    }
  ],
  "origin": "n8n",
  "pinData": {
    "Webhook": [
      {
        "json": {
          "headers": {
            "host": "personal-n8n.rk9l1c.easypanel.host",
            "user-agent": "axios/1.7.9",
            "content-length": "12636",
            "accept-encoding": "gzip, compress, deflate, br",
            "content-type": "application/json",
            "x-forwarded-for": "172.18.0.1",
            "x-forwarded-host": "personal-n8n.rk9l1c.easypanel.host",
            "x-forwarded-port": "443",
            "x-forwarded-proto": "https",
            "x-forwarded-server": "227e2e43f3cd",
            "x-real-ip": "172.18.0.1"
          },
          "params": {},
          "query": {},
          "body": {
            "event": "messages.upsert",
            "instance": "calidaxBot",
            "data": {
              "key": {
                "remoteJid": "34612575083@s.whatsapp.net",
                "fromMe": false,
                "id": "AC59661FBEB11C87CCC58827DC34E051"
              },
              "pushName": "",
              "status": "ERROR",
              "message": {
                "audioMessage": {
                  "url": "https://mmg.whatsapp.net/v/t62.7117-24/604352738_1187630080008103_7881021219329743561_n.enc?ccb=11-4&oh=01_Q5Aa3QGDpYTCqRNfMuxxpJqoBXLekQrJsE6nuB_Sjm6A1mXSsA&oe=69710B99&_nc_sid=5e03e0&mms3=true",
                  "mimetype": "audio/ogg; codecs=opus",
                  "fileSha256": "larU85cIlNWJOqC4LMUsa3lyw4jhcfIZ7YLt4rEEoAI=",
                  "fileLength": "8341",
                  "seconds": 4,
                  "ptt": true,
                  "mediaKey": "7Leth8MHApKF8oGpFZJtES7NbV6xT68G1v5ZadP1Hos=",
                  "fileEncSha256": "/YfKXJdUTXeZEqNuNRElWsuejAW0faNWozKxxQtvbRc=",
                  "directPath": "/v/t62.7117-24/604352738_1187630080008103_7881021219329743561_n.enc?ccb=11-4&oh=01_Q5Aa3QGDpYTCqRNfMuxxpJqoBXLekQrJsE6nuB_Sjm6A1mXSsA&oe=69710B99&_nc_sid=5e03e0",
                  "mediaKeyTimestamp": "1766432595",
                  "waveform": "AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAmPT08OigxOCMnNSo1PRM9QDs3NDs7FykgIzEoMCMrNSobAA=="
                },
                "messageContextInfo": {
                  "messageSecret": "mgjtS0gHihRlYS9Hf0mcCE3Q8A/grTut0wbX7CYI+CY="
                },
                "base64": "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"
              },
              "contextInfo": null,
              "messageType": "audioMessage",
              "messageTimestamp": 1766432598,
              "instanceId": "b556d824-9d0f-4f2b-849d-bd7b32d7ac6d",
              "source": "android"
            },
            "destination": "https://personal-n8n.rk9l1c.easypanel.host/webhook/calidax",
            "date_time": "2025-12-22T16:43:24.485Z",
            "sender": "34604863683@s.whatsapp.net",
            "server_url": "https://personal-evolution-api.rk9l1c.easypanel.host",
            "apikey": "2F69A1ACA0A6-476C-9366-06C400631ED5"
          },
          "webhookUrl": "https://personal-n8n.rk9l1c.easypanel.host/webhook/calidax",
          "executionMode": "production"
        }
      }
    ]
  },
  "repo": {
    "owner": "abdeidr",
    "name": "n8n"
  },
  "settings": {
    "executionOrder": "v1"
  },
  "shared": [
    {
      "updatedAt": "2025-10-06T14:04:18.429Z",
      "createdAt": "2025-10-06T14:04:18.429Z",
      "role": "workflow:owner",
      "workflowId": "5baZQi4nBrmXGEH1",
      "projectId": "xdZYvePgLSibegaD"
    }
  ],
  "staticData": null,
  "tags": [],
  "triggerCount": 1,
  "updatedAt": "2025-12-22T19:49:50.000Z",
  "versionId": "a08ed1ac-e202-443c-9f00-f8811681ff65"
}